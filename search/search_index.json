{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"ARC? \u00b6 ARC by SourceFuse is an open source rapid application development framework for development of modern cloud native enterprise applications that leverages a catalog of prebuilt microservices and deployed as per standardized reference architecture on both private and public clouds.","title":"ARC?"},{"location":"#arc","text":"ARC by SourceFuse is an open source rapid application development framework for development of modern cloud native enterprise applications that leverages a catalog of prebuilt microservices and deployed as per standardized reference architecture on both private and public clouds.","title":"ARC?"},{"location":"arc-api-docs/","text":"ARC API \u00b6 The Sourceloop is a collection of pre-built microservices that aim to reduce time to market for enterprise projects. Large enterprises usually face a similar set of challenges when developing cloud native platforms as part of digital transformation efforts or the creation of new products. The services are implemented as LoopBack Extensions , allowing you to install them into existing LoopBack applications or use the LoopBack Command-line interface to generate standalone services. Our recommended approach is to deploy these services as standalone micro-services in Docker. The current catalog consists of the following services: audit-service authentication-service in-mail-service notification-service scheduler-service video-conferencing-service bpmn-service chat-service feature-toggle-service payment-service search-service This repository also contains a set of example projects in the sandbox directory that can be run from docker-compose . audit-ms-example auth-multitenant-example auth-ms-basic-example notification-socket-example workflow-ms-example audit-ms-example in-mail-example scheduler-example video-conferencing-ms-example chat-notification-pubnub-example feature-toggle-example payment-example search-client-example search-ms-example user-onboarding-example Table of Contents \u00b6 Sourceloop Table of Contents Long Term Support Documentation Getting Started Production Deployment Related Projects Feedback Contributing Code of Conduct License Long Term Support \u00b6 TODO: Establish LTS policy or document here that the catalog is still in development and has not reached an LTS release yet. Version Status Published EOL Documentation \u00b6 LoopBack| LoopBack Documentation Extending LoopBack | LoopBack Documentation Getting Started \u00b6 For specifics of installing and configuring a particular service, please refer to that service's documentation. The guide here is intended to show the general method for installing and configuring the services. We are going to utilize a fictional service, @sourceloop/example-service , as an example. All services load their environment configurations using dotenv and dotenv-extended . Install the Loopback4 CLI 1 npm install -g @loopback/cli Generate an application (If you don't have one already). 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 lb4 app ? Project name: example-application ? Project description: Example Application For SourceLoop ? Project root directory: example-application ? Application class name: ExampleApplicationApplication ? Select features to enable in the project Enable eslint, Enable prettier, Enable mocha, Enable loopbackBuild, Enable vs code, Enable docker, Enable repositories, Enable services force .yo-rc.json create .eslintignore create .eslintrc.js create .mocharc.json create .npmrc create .prettierignore create .prettierrc create DEVELOPING.md create package.json create tsconfig.json create .vscode \\l aunch.json create .vscode \\s ettings.json create .vscode \\t asks.json create .gitignore create .dockerignore create Dockerfile create README.md create public \\i ndex.html create src \\a pplication.ts create src \\i ndex.ts create src \\m igrate.ts create src \\o penapi-spec.ts create src \\s equence.ts create src \\c ontrollers \\i ndex.ts create src \\c ontrollers \\p ing.controller.ts create src \\c ontrollers \\R EADME.md create src \\d atasources \\R EADME.md create src \\m odels \\R EADME.md create src \\r epositories \\R EADME.md create src \\_ _tests__ \\R EADME.md create src \\_ _tests__ \\a cceptance \\h ome-page.acceptance.ts create src \\_ _tests__ \\a cceptance \\p ing.controller.acceptance.ts create src \\_ _tests__ \\a cceptance \\t est-helper.ts npm WARN deprecated debug@4.2.0: Debug versions > = 3 .2.0 < 3 .2.7 || > = 4 < 4 .3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3 .2.7 or 4 .3.1. ( https://github.com/visionmedia/debug/issues/797 ) npm WARN deprecated fsevents@2.1.3: \"Please update to latest v2.3 or v2.2\" npm notice created a lockfile as package-lock.json. You should commit this file. npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@~2.1.2 ( node_modules \\c hokidar \\n ode_modules \\f sevents ) : npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.3: wanted { \"os\" : \"darwin\" , \"arch\" : \"any\" } ( current: { \"os\" : \"win32\" , \"arch\" : \"x64\" }) npm WARN example-application@0.0.1 No license field. added 637 packages from 816 contributors and audited 646 packages in 16 .345s 87 packages are looking for funding run ` npm fund ` for details found 0 vulnerabilities Application example-application was created in example-application. Next steps: $ cd example-application $ npm start Install dotenv , dotenv-extended and @sourceloop/example-service . 1 2 3 cd example-application npm i --save dotenv dotenv-extended @sourceloop/example-service touch .env.example Update src/application.ts to use the new service component and the environment variables. You may also need to bind configurations depending on the service component you are using. You find these configurations in the individual README of the service. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 import { BootMixin } from '@loopback/boot' ; import { ApplicationConfig } from '@loopback/core' ; import { RestExplorerBindings , RestExplorerComponent , } from '@loopback/rest-explorer' ; import { RepositoryMixin } from '@loopback/repository' ; import { RestApplication } from '@loopback/rest' ; import { ServiceMixin } from '@loopback/service-proxy' ; import path from 'path' ; import { MySequence } from './sequence' ; import { ExampleServiceComponent } from '@sourceloop/example-service' ; import * as dotenv from 'dotenv' ; import * as dotenvExt from 'dotenv-extended' ; export { ApplicationConfig }; const port = 3000 ; export class ExampleApplicationApplication extends BootMixin ( ServiceMixin ( RepositoryMixin ( RestApplication )), ) { constructor ( options : ApplicationConfig = {}) { dotenv . config (); dotenvExt . load ({ schema : '.env.example' , errorOnMissing : true , includeProcessEnv : true , }); options . rest = options . rest || {}; options . rest . port = + ( process . env . PORT ?? port ); options . rest . host = process . env . HOST ; super ( options ); // Set up the custom sequence this . sequence ( MySequence ); // Set up default home page this . static ( '/' , path . join ( __dirname , '../public' )); // Customize @loopback/rest-explorer configuration here this . configure ( RestExplorerBindings . COMPONENT ). to ({ path : '/explorer' , }); this . component ( RestExplorerComponent ); this . component ( ExampleServiceComponent ); // OUR EXAMPLE SERVICE COMPONENT this . projectRoot = __dirname ; // Customize @loopback/boot Booter Conventions here this . bootOptions = { controllers : { // Customize ControllerBooter Conventions here dirs : [ 'controllers' ], extensions : [ '.controller.js' ], nested : true , }, }; } } Modify the environment variable file to have the following contents: 1 NODE_ENV=dev You can now run the example service with npm start . Config Hidden APIs \u00b6 Update src/application.ts of each service to use the new hidden api feature. Add the following lines 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 import { OperationSpecEnhancer } from './enhancer/operationSpecEnhancer' ; import { OASBindings } from './keys' ; import { HttpMethod } from './enums/http-oas.enum' ; export class ExampleApplicationApplication extends BootMixin ( ServiceMixin ( RepositoryMixin ( RestApplication )), ) { constructor ( options : ApplicationConfig = {}) { super ( options ); // Set up the custom sequence this . sequence ( MySequence ); // Set up default home page this . static ( '/' , path . join ( __dirname , '../public' )); // Customize @loopback/rest-explorer configuration here this . configure ( RestExplorerBindings . COMPONENT ). to ({ path : '/explorer' , }); this . component ( RestExplorerComponent ); // Bind OASBinding namespace to hide APIs this . bind ( OASBindings . HiddenEndpoint ). to ([ { httpMethod : HttpMethod.GET , path : '/ping' }, { httpMethod : HttpMethod.POST , path : '/customers/{id}/users' }, { httpMethod : HttpMethod.PUT , path : '/roles/{id}' }, ]); this . projectRoot = __dirname ; // Customize @loopback/boot Booter Conventions here this . bootOptions = { controllers : { // Customize ControllerBooter Conventions here dirs : [ 'controllers' ], extensions : [ '.controller.js' ], nested : true , }, }; } } DataSources and Migrations \u00b6 The Sourceloop can support any Loopback 4 DataSource . While you may see existing DataSources , it is not mandatory to use them. The migrations required for this service are processed during the installation automatically if you set the SOURCELOOP_MIGRATION env variable. The migrations use db-migrate with db-migrate-pg driver for migrations, so you will have to install these packages to use auto-migration. Please note that if you are using some pre-existing migrations or databases, they may be affected. In such a scenario, it is advised that you copy the migration files in your project root, using the SOURCELOOP_MIGRATION_COPY env variables. You can customize or cherry-pick the migrations in the copied files according to your specific requirements and then apply them to the DB. Production Deployment \u00b6 Inside of the sandbox folder, you will find example applications and Dockerfiles for each application. The Sourceloop is agnostic of the Docker deployment strategy. Deploy the services into the platform of your choice. Sandbox \u00b6 sandbox folder contains example applications and docker files that can be run independently to see the services in action. You can use Docker Compose to run the sandbox applications. Sourceloop CLI \u00b6 The Sourceloop CLI is a command-line interface tool that one use to initialize, develop, scaffold, and maintain sourceloop applications directly from a command shell. Learn more about Sourceloop CLI . Related Projects \u00b6 The Sourceloop utilizes many extensions created by SourceFuse. sourcefuse/loopback4-ratelimiter: A rate limiting extension for loopback4 applications (github.com) sourcefuse/loopback4-notifications: An extension for setting up various notification mechanisms in loopback4 application, vis-a-vis, Push notification, SMS notification, Email notification (github.com) sourcefuse/loopback4-s3: A loopback4 extension for AWS S3 integration (github.com) sourcefuse/loopback4-audit-log: A loopback-next extension for implementing audit logs in loopback applications for all DB transactions. (github.com) sourcefuse/loopback4-soft-delete: A loopback4 extension for soft delete feature (github.com) sourcefuse/loopback4-authentication: A loopback-next extension for authentication feature. Oauth strategies supported. (github.com) sourcefuse/loopback4-authorization: An authorization extension for loopback4 applications (github.com) sourcefuse/loopback4-helmet: A loopback4 extension for helmetjs integration (github.com) sourcefuse/loopback4-vault: A loopback-next extension for HashiCorp's Vault integration in loopback-next applications (github.com) sourcefuse/loopback4-kafka-client: A Kafka Client for Loopback4 built on top of KafkaJS (github.com) sourcefuse/loopback4-dynamic-datasource: A loopback 4 extension to connect to dynamic data sources runtime while maintaining old connections (github.com) sourcefuse/loopback4-sequelize: A Loopback 4 Extension that provides Sequelize query builder at repository level (github.com) Feedback \u00b6 If you've noticed a bug or have a question or have a feature request, search the issue tracker to see if someone else in the community has already created a ticket. If not, go ahead and make one ! All feature requests are welcome. Implementation time may vary. Feel free to contribute the same, if you can. If you think this extension is useful, please star it. Appreciation really helps in keeping this project alive. Contributing \u00b6 Development Guidelines Code of Conduct \u00b6 Code of conduct guidelines here. License \u00b6 MIT","title":"Introduction"},{"location":"arc-api-docs/#arc-api","text":"The Sourceloop is a collection of pre-built microservices that aim to reduce time to market for enterprise projects. Large enterprises usually face a similar set of challenges when developing cloud native platforms as part of digital transformation efforts or the creation of new products. The services are implemented as LoopBack Extensions , allowing you to install them into existing LoopBack applications or use the LoopBack Command-line interface to generate standalone services. Our recommended approach is to deploy these services as standalone micro-services in Docker. The current catalog consists of the following services: audit-service authentication-service in-mail-service notification-service scheduler-service video-conferencing-service bpmn-service chat-service feature-toggle-service payment-service search-service This repository also contains a set of example projects in the sandbox directory that can be run from docker-compose . audit-ms-example auth-multitenant-example auth-ms-basic-example notification-socket-example workflow-ms-example audit-ms-example in-mail-example scheduler-example video-conferencing-ms-example chat-notification-pubnub-example feature-toggle-example payment-example search-client-example search-ms-example user-onboarding-example","title":"ARC API"},{"location":"arc-api-docs/#table-of-contents","text":"Sourceloop Table of Contents Long Term Support Documentation Getting Started Production Deployment Related Projects Feedback Contributing Code of Conduct License","title":"Table of Contents"},{"location":"arc-api-docs/#long-term-support","text":"TODO: Establish LTS policy or document here that the catalog is still in development and has not reached an LTS release yet. Version Status Published EOL","title":"Long Term Support"},{"location":"arc-api-docs/#documentation","text":"LoopBack| LoopBack Documentation Extending LoopBack | LoopBack Documentation","title":"Documentation"},{"location":"arc-api-docs/#getting-started","text":"For specifics of installing and configuring a particular service, please refer to that service's documentation. The guide here is intended to show the general method for installing and configuring the services. We are going to utilize a fictional service, @sourceloop/example-service , as an example. All services load their environment configurations using dotenv and dotenv-extended . Install the Loopback4 CLI 1 npm install -g @loopback/cli Generate an application (If you don't have one already). 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 lb4 app ? Project name: example-application ? Project description: Example Application For SourceLoop ? Project root directory: example-application ? Application class name: ExampleApplicationApplication ? Select features to enable in the project Enable eslint, Enable prettier, Enable mocha, Enable loopbackBuild, Enable vs code, Enable docker, Enable repositories, Enable services force .yo-rc.json create .eslintignore create .eslintrc.js create .mocharc.json create .npmrc create .prettierignore create .prettierrc create DEVELOPING.md create package.json create tsconfig.json create .vscode \\l aunch.json create .vscode \\s ettings.json create .vscode \\t asks.json create .gitignore create .dockerignore create Dockerfile create README.md create public \\i ndex.html create src \\a pplication.ts create src \\i ndex.ts create src \\m igrate.ts create src \\o penapi-spec.ts create src \\s equence.ts create src \\c ontrollers \\i ndex.ts create src \\c ontrollers \\p ing.controller.ts create src \\c ontrollers \\R EADME.md create src \\d atasources \\R EADME.md create src \\m odels \\R EADME.md create src \\r epositories \\R EADME.md create src \\_ _tests__ \\R EADME.md create src \\_ _tests__ \\a cceptance \\h ome-page.acceptance.ts create src \\_ _tests__ \\a cceptance \\p ing.controller.acceptance.ts create src \\_ _tests__ \\a cceptance \\t est-helper.ts npm WARN deprecated debug@4.2.0: Debug versions > = 3 .2.0 < 3 .2.7 || > = 4 < 4 .3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3 .2.7 or 4 .3.1. ( https://github.com/visionmedia/debug/issues/797 ) npm WARN deprecated fsevents@2.1.3: \"Please update to latest v2.3 or v2.2\" npm notice created a lockfile as package-lock.json. You should commit this file. npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@~2.1.2 ( node_modules \\c hokidar \\n ode_modules \\f sevents ) : npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.3: wanted { \"os\" : \"darwin\" , \"arch\" : \"any\" } ( current: { \"os\" : \"win32\" , \"arch\" : \"x64\" }) npm WARN example-application@0.0.1 No license field. added 637 packages from 816 contributors and audited 646 packages in 16 .345s 87 packages are looking for funding run ` npm fund ` for details found 0 vulnerabilities Application example-application was created in example-application. Next steps: $ cd example-application $ npm start Install dotenv , dotenv-extended and @sourceloop/example-service . 1 2 3 cd example-application npm i --save dotenv dotenv-extended @sourceloop/example-service touch .env.example Update src/application.ts to use the new service component and the environment variables. You may also need to bind configurations depending on the service component you are using. You find these configurations in the individual README of the service. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 import { BootMixin } from '@loopback/boot' ; import { ApplicationConfig } from '@loopback/core' ; import { RestExplorerBindings , RestExplorerComponent , } from '@loopback/rest-explorer' ; import { RepositoryMixin } from '@loopback/repository' ; import { RestApplication } from '@loopback/rest' ; import { ServiceMixin } from '@loopback/service-proxy' ; import path from 'path' ; import { MySequence } from './sequence' ; import { ExampleServiceComponent } from '@sourceloop/example-service' ; import * as dotenv from 'dotenv' ; import * as dotenvExt from 'dotenv-extended' ; export { ApplicationConfig }; const port = 3000 ; export class ExampleApplicationApplication extends BootMixin ( ServiceMixin ( RepositoryMixin ( RestApplication )), ) { constructor ( options : ApplicationConfig = {}) { dotenv . config (); dotenvExt . load ({ schema : '.env.example' , errorOnMissing : true , includeProcessEnv : true , }); options . rest = options . rest || {}; options . rest . port = + ( process . env . PORT ?? port ); options . rest . host = process . env . HOST ; super ( options ); // Set up the custom sequence this . sequence ( MySequence ); // Set up default home page this . static ( '/' , path . join ( __dirname , '../public' )); // Customize @loopback/rest-explorer configuration here this . configure ( RestExplorerBindings . COMPONENT ). to ({ path : '/explorer' , }); this . component ( RestExplorerComponent ); this . component ( ExampleServiceComponent ); // OUR EXAMPLE SERVICE COMPONENT this . projectRoot = __dirname ; // Customize @loopback/boot Booter Conventions here this . bootOptions = { controllers : { // Customize ControllerBooter Conventions here dirs : [ 'controllers' ], extensions : [ '.controller.js' ], nested : true , }, }; } } Modify the environment variable file to have the following contents: 1 NODE_ENV=dev You can now run the example service with npm start .","title":"Getting Started"},{"location":"arc-api-docs/#config-hidden-apis","text":"Update src/application.ts of each service to use the new hidden api feature. Add the following lines 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 import { OperationSpecEnhancer } from './enhancer/operationSpecEnhancer' ; import { OASBindings } from './keys' ; import { HttpMethod } from './enums/http-oas.enum' ; export class ExampleApplicationApplication extends BootMixin ( ServiceMixin ( RepositoryMixin ( RestApplication )), ) { constructor ( options : ApplicationConfig = {}) { super ( options ); // Set up the custom sequence this . sequence ( MySequence ); // Set up default home page this . static ( '/' , path . join ( __dirname , '../public' )); // Customize @loopback/rest-explorer configuration here this . configure ( RestExplorerBindings . COMPONENT ). to ({ path : '/explorer' , }); this . component ( RestExplorerComponent ); // Bind OASBinding namespace to hide APIs this . bind ( OASBindings . HiddenEndpoint ). to ([ { httpMethod : HttpMethod.GET , path : '/ping' }, { httpMethod : HttpMethod.POST , path : '/customers/{id}/users' }, { httpMethod : HttpMethod.PUT , path : '/roles/{id}' }, ]); this . projectRoot = __dirname ; // Customize @loopback/boot Booter Conventions here this . bootOptions = { controllers : { // Customize ControllerBooter Conventions here dirs : [ 'controllers' ], extensions : [ '.controller.js' ], nested : true , }, }; } }","title":"Config Hidden APIs"},{"location":"arc-api-docs/#datasources-and-migrations","text":"The Sourceloop can support any Loopback 4 DataSource . While you may see existing DataSources , it is not mandatory to use them. The migrations required for this service are processed during the installation automatically if you set the SOURCELOOP_MIGRATION env variable. The migrations use db-migrate with db-migrate-pg driver for migrations, so you will have to install these packages to use auto-migration. Please note that if you are using some pre-existing migrations or databases, they may be affected. In such a scenario, it is advised that you copy the migration files in your project root, using the SOURCELOOP_MIGRATION_COPY env variables. You can customize or cherry-pick the migrations in the copied files according to your specific requirements and then apply them to the DB.","title":"DataSources and Migrations"},{"location":"arc-api-docs/#production-deployment","text":"Inside of the sandbox folder, you will find example applications and Dockerfiles for each application. The Sourceloop is agnostic of the Docker deployment strategy. Deploy the services into the platform of your choice.","title":"Production Deployment"},{"location":"arc-api-docs/#sandbox","text":"sandbox folder contains example applications and docker files that can be run independently to see the services in action. You can use Docker Compose to run the sandbox applications.","title":"Sandbox"},{"location":"arc-api-docs/#sourceloop-cli","text":"The Sourceloop CLI is a command-line interface tool that one use to initialize, develop, scaffold, and maintain sourceloop applications directly from a command shell. Learn more about Sourceloop CLI .","title":"Sourceloop CLI"},{"location":"arc-api-docs/#related-projects","text":"The Sourceloop utilizes many extensions created by SourceFuse. sourcefuse/loopback4-ratelimiter: A rate limiting extension for loopback4 applications (github.com) sourcefuse/loopback4-notifications: An extension for setting up various notification mechanisms in loopback4 application, vis-a-vis, Push notification, SMS notification, Email notification (github.com) sourcefuse/loopback4-s3: A loopback4 extension for AWS S3 integration (github.com) sourcefuse/loopback4-audit-log: A loopback-next extension for implementing audit logs in loopback applications for all DB transactions. (github.com) sourcefuse/loopback4-soft-delete: A loopback4 extension for soft delete feature (github.com) sourcefuse/loopback4-authentication: A loopback-next extension for authentication feature. Oauth strategies supported. (github.com) sourcefuse/loopback4-authorization: An authorization extension for loopback4 applications (github.com) sourcefuse/loopback4-helmet: A loopback4 extension for helmetjs integration (github.com) sourcefuse/loopback4-vault: A loopback-next extension for HashiCorp's Vault integration in loopback-next applications (github.com) sourcefuse/loopback4-kafka-client: A Kafka Client for Loopback4 built on top of KafkaJS (github.com) sourcefuse/loopback4-dynamic-datasource: A loopback 4 extension to connect to dynamic data sources runtime while maintaining old connections (github.com) sourcefuse/loopback4-sequelize: A Loopback 4 Extension that provides Sequelize query builder at repository level (github.com)","title":"Related Projects"},{"location":"arc-api-docs/#feedback","text":"If you've noticed a bug or have a question or have a feature request, search the issue tracker to see if someone else in the community has already created a ticket. If not, go ahead and make one ! All feature requests are welcome. Implementation time may vary. Feel free to contribute the same, if you can. If you think this extension is useful, please star it. Appreciation really helps in keeping this project alive.","title":"Feedback"},{"location":"arc-api-docs/#contributing","text":"Development Guidelines","title":"Contributing"},{"location":"arc-api-docs/#code-of-conduct","text":"Code of conduct guidelines here.","title":"Code of Conduct"},{"location":"arc-api-docs/#license","text":"MIT","title":"License"},{"location":"arc-iac-docs/","text":"arc-iac-docs \u00b6 ARC Infrastructure As Code (IaC) documentation.","title":"Introduction"},{"location":"arc-iac-docs/#arc-iac-docs","text":"ARC Infrastructure As Code (IaC) documentation.","title":"arc-iac-docs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/","text":"terraform-aws-ref-arch-db \u00b6 This project was generated by generator-tf-module Overview \u00b6 SourceFuse AWS Reference Architecture (ARC) Terraform module for managing Aurora and RDS instances. Usage \u00b6 To see a full example, check out the main.tf file in the example folder. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 module \"aurora\" { source = \"git::https://github.com/sourcefuse/terraform-aws-ref-arch-db\" environment = \"dev\" namespace = \"arc\" vpc_id = \"vpc-000111222333444\" aurora_cluster_enabled = true aurora_cluster_name = \"aurora-example\" enhanced_monitoring_name = \"aurora-example-enhanced-monitoring\" aurora_db_admin_username = \"example_db_admin\" aurora_db_name = \"example\" aurora_allow_major_version_upgrade = true aurora_auto_minor_version_upgrade = true aurora_cluster_size = 0 aurora_instance_type = \"db.serverless\" aurora_subnets = [ \"subnet-0001112223334441\" , \"subnet-0001112223334442\" , ] aurora_security_groups = [ \"sg-0001112223334441\" , \"sg-0001112223334442\" ] aurora_allowed_cidr_blocks = [ \"10.0.0.0/16\" ] aurora_serverlessv2_scaling_configuration = { max_capacity = 16 min_capacity = 2 } } Requirements \u00b6 Name Version terraform >= 1.2 aws ~> 4.44 null ~> 3.1.1 random ~> 3.4.0 Providers \u00b6 Name Version aws 4.57.0 random 3.4.3 Modules \u00b6 Name Source Version aurora_cluster git:: https://github.com/cloudposse/terraform-aws-rds-cluster.git 1.3.2 db_management git:: https://github.com/cloudposse/terraform-aws-s3-bucket 3.0.0 rds_instance git:: https://github.com/cloudposse/terraform-aws-rds 0.40.0 this cloudposse/label/null 0.25.0 Resources \u00b6 Name Type aws_db_option_group.this resource aws_iam_policy.option_group resource aws_iam_role.enhanced_monitoring resource aws_iam_role.option_group resource aws_iam_role_policy_attachment.enhanced_monitoring resource aws_iam_role_policy_attachment.option_group resource aws_kms_alias.aurora_cluster_kms_key resource aws_kms_alias.rds_db_kms_key resource aws_kms_key.aurora_cluster_kms_key resource aws_kms_key.rds_db_kms_key resource aws_ssm_parameter.this resource random_password.aurora_db_admin_password resource random_password.rds_db_admin_password resource aws_iam_policy_document.enhanced_monitoring data source Inputs \u00b6 Name Description Type Default Required account_id Account ID where the resources will be deployed to. This is required if enable_custom_option_group is set to true . string \"\" no additional_tag_map Additional key-value pairs to add to each map in tags_as_list_of_maps . Not added to tags or id . This is for some rare cases where resources want additional configuration of tags and therefore take a list of maps with tag key, value, and additional configuration. map(string) {} no attributes ID element. Additional attributes (e.g. workers or cluster ) to add to id , in the order they appear in the list. New attributes are appended to the end of the list. The elements of the list are joined by the delimiter and treated as a single ID element. list(string) [] no aurora_allow_major_version_upgrade Enable to allow major engine version upgrades when changing engine versions. Defaults to false. bool false no aurora_allowed_cidr_blocks List of CIDR blocks allowed to access the cluster list(string) [] no aurora_auto_minor_version_upgrade Indicates that minor engine upgrades will be applied automatically to the DB instance during the maintenance window bool true no aurora_cluster_enabled Enable creation of an Aurora Cluster bool false no aurora_cluster_family The family of the DB cluster parameter group string \"aurora-postgresql14\" no aurora_cluster_name Database name (default is not to create a database) string \"\" no aurora_cluster_size Number of DB instances to create in the cluster number 0 no aurora_db_admin_password Password of the DB admin string \"\" no aurora_db_admin_username Name of the default DB admin user role string \"\" no aurora_db_name Database name. string \"auroradb\" no aurora_engine The name of the database engine to be used for this DB cluster. Valid values: aurora , aurora-mysql , aurora-postgresql string \"aurora-postgresql\" no aurora_engine_mode The database engine mode. Valid values: parallelquery , provisioned , serverless string \"provisioned\" no aurora_engine_version The version of the database engine tocl use. See aws rds describe-db-engine-versions string \"14.5\" no aurora_instance_type Instance type to use string \"db.serverless\" no aurora_scaling_configuration List of nested attributes with scaling properties. Only valid when engine_mode is set to serverless list(object({ auto_pause = bool max_capacity = number min_capacity = number seconds_until_auto_pause = number timeout_action = string })) [] no aurora_security_groups List of security group IDs to be allowed to connect to the DB instance list(string) [] no aurora_serverlessv2_scaling_configuration serverlessv2 scaling properties object({ min_capacity = number max_capacity = number }) null no aurora_subnets Subnets for the cluster to run in. list(string) [] no context Single object for setting entire context at once. See description of individual variables for details. Leave string and numeric variables as null to use default value. Individual variable settings (non-null) override settings in context object, except for attributes, tags, and additional_tag_map, which are merged. any { \"additional_tag_map\": {}, \"attributes\": [], \"delimiter\": null, \"descriptor_formats\": {}, \"enabled\": true, \"environment\": null, \"id_length_limit\": null, \"label_key_case\": null, \"label_order\": [], \"label_value_case\": null, \"labels_as_tags\": [ \"unset\" ], \"name\": null, \"namespace\": null, \"regex_replace_chars\": null, \"stage\": null, \"tags\": {}, \"tenant\": null } no deletion_protection Protect the instance from being deleted bool false no deletion_window_in_days n/a number 10 no delimiter Delimiter to be used between ID elements. Defaults to - (hyphen). Set to \"\" to use no delimiter at all. string null no descriptor_formats Describe additional descriptors to be output in the descriptors output map. Map of maps. Keys are names of descriptors. Values are maps of the form {<br> format = string<br> labels = list(string)<br>} (Type is any so the map values can later be enhanced to provide additional options.) format is a Terraform format string to be passed to the format() function. labels is a list of labels, in order, to pass to format() function. Label values will be normalized before being passed to format() so they will be identical to how they appear in id . Default is {} ( descriptors output will be empty). any {} no enable_custom_option_group Enable the custom Option Group for restoring backups via S3 bool false no enable_key_rotation n/a bool true no enabled Set to false to prevent the module from creating any resources bool null no enhanced_monitoring_arn ARN to the enhanced monitoring policy string \"arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole\" no enhanced_monitoring_name Name to assign the enhanced monitoring resources. string n/a yes environment ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT' string n/a yes id_length_limit Limit id to this many characters (minimum 6). Set to 0 for unlimited length. Set to null for keep the existing setting, which defaults to 0 . Does not affect id_full . number null no label_key_case Controls the letter case of the tags keys (label names) for tags generated by this module. Does not affect keys of tags passed in via the tags input. Possible values: lower , title , upper . Default value: title . string null no label_order The order in which the labels (ID elements) appear in the id . Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"]. You can omit any of the 6 labels (\"tenant\" is the 6 th ), but at least one must be present. list(string) null no label_value_case Controls the letter case of ID elements (labels) as included in id , set as tag values, and output by this module individually. Does not affect values of tags passed in via the tags input. Possible values: lower , title , upper and none (no transformation). Set this to title and set delimiter to \"\" to yield Pascal Case IDs. Default value: lower . string null no labels_as_tags Set of labels (ID elements) to include as tags in the tags output. Default is to include all labels. Tags with empty values will not be included in the tags output. Set to [] to suppress all generated tags. Notes: The value of the name tag, if included, will be the id , not the name . Unlike other null-label inputs, the initial setting of labels_as_tags cannot be changed in later chained modules. Attempts to change it will be silently ignored. set(string) [ \"default\" ] no name ID element. Usually the component or solution name, e.g. 'app' or 'jenkins'. This is the only ID element not also included as a tag . The \"name\" tag is set to the full id string. There is no tag with the value of the name input. string null no namespace ID element. Usually an abbreviation of your organization name, e.g. 'eg' or 'cp', to help ensure generated IDs are globally unique string n/a yes rds_instance_allocated_storage The allocated storage in GBs. Required unless a snapshot_identifier or replicate_source_db is provided. number 20 no rds_instance_allow_major_version_upgrade Allow major version upgrade bool false no rds_instance_allowed_cidr_blocks The whitelisted CIDRs which to allow ingress traffic to the DB instance list(string) [] no rds_instance_apply_immediately Specifies whether any database modifications are applied immediately, or during the next maintenance window bool true no rds_instance_auto_minor_version_upgrade Allow automated minor version upgrade (e.g. from Postgres 9.5.3 to Postgres 9.5.4) bool true no rds_instance_backup_retention_period Backup retention period in days. Must be > 0 to enable backups number 0 no rds_instance_backup_window When AWS can perform DB snapshots, can't overlap with maintenance window string \"22:00-03:00\" no rds_instance_ca_cert_identifier The identifier of the CA certificate for the DB instance string null no rds_instance_copy_tags_to_snapshot Copy tags from DB to a snapshot bool true no rds_instance_database_name The name of the database to create when the DB instance is created string null no rds_instance_database_password Password for the primary DB user. Required unless a snapshot_identifier or replicate_source_db is provided. string \"\" no rds_instance_database_port Database port (_e.g._ 3306 for MySQL). Used in the DB Security Group to allow access to the DB instance from the provided security_group_ids number 5432 no rds_instance_database_user The name of the database to create when the DB instance is created string \"admin\" no rds_instance_db_options A list of DB options to apply with an option group. Depends on DB engine list(object({ db_security_group_memberships = list(string) option_name = string port = number version = string vpc_security_group_memberships = list(string) option_settings = list(object({ name = string value = string })) })) [] no rds_instance_db_parameter A list of DB parameters to apply. Note that parameters may differ from a DB family to another list(object({ apply_method = string name = string value = string })) [] no rds_instance_db_parameter_group The DB parameter group family name. The value depends on DB engine used. See DBParameterGroupFamily for instructions on how to retrieve applicable value. string \"postgres14\" no rds_instance_dns_zone_id The ID of the DNS Zone in Route53 where a new DNS record will be created for the DB host name string \"\" no rds_instance_enabled Enable creation of an RDS instance bool false no rds_instance_engine Database engine type. Required unless a snapshot_identifier or replicate_source_db is provided. For supported values, see the Engine parameter in API action CreateDBInstance. string \"postgres\" no rds_instance_engine_version Database engine version, depends on engine type. Required unless a snapshot_identifier or replicate_source_db is provided. string \"14.3\" no rds_instance_host_name The DB host name created in Route53 string \"db\" no rds_instance_instance_class Class of RDS instance string \"db.t2.medium\" no rds_instance_license_model License model for this DB. Optional, but required for some DB Engines. Valid values: license-included | bring-your-own-license | general-public-license string \"\" no rds_instance_maintenance_window The window to perform maintenance in. Syntax: 'ddd:hh24:mi-ddd:hh24:mi' UTC string \"Mon:03:00-Mon:04:00\" no rds_instance_major_engine_version major_engine_version Database MAJOR engine version, depends on engine type string \"14\" no rds_instance_multi_az Set to true if multi AZ deployment must be supported bool false no rds_instance_name RDS Instance name string \"\" no rds_instance_option_group_name Name of the DB option group to associate string \"\" no rds_instance_publicly_accessible Determines if database can be publicly available (NOT recommended) bool false no rds_instance_security_group_ids The IDs of the security groups from which to allow ingress traffic to the DB instance list(string) [] no rds_instance_skip_final_snapshot If true (default), no snapshot will be made before deleting DB bool true no rds_instance_snapshot_identifier Snapshot identifier e.g: rds:production-2019-06-26-06-05. If specified, the module create cluster from the snapshot string null no rds_instance_storage_encrypted Specifies whether the DB instance is encrypted. The default is false if not specified bool true no rds_instance_storage_type One of 'standard' (magnetic), 'gp2' (general purpose SSD), or 'io1' (provisioned IOPS SSD) string \"gp2\" no rds_instance_subnet_ids List of subnet IDs for the DB. DB instance will be created in the VPC associated with the DB subnet group provisioned using the subnet IDs. Specify one of subnet_ids, db_subnet_group_name or availability_zone list(string) [] no rds_kms_key_arn_override Override the default created KMS key to encrypt storage string \"\" no rds_kms_key_id_override Override the default created KMS key ID to encrypt storage string \"\" no regex_replace_chars Terraform regular expression (regex) string. Characters matching the regex will be removed from the ID elements. If not set, \"/[^a-zA-Z0-9-]/\" is used to remove all characters other than hyphens, letters and digits. string null no region Region which the resource is deployed to string \"us-east-1\" no s3_kms_alias_override Override the KMS key alias for the S3 bucket. Default is set to AWS Managed KMS alias. string \"\" no stage ID element. Usually used to indicate role, e.g. 'prod', 'staging', 'source', 'build', 'test', 'deploy', 'release' string null no tags Additional tags (e.g. {'BusinessUnit': 'XYZ'} ). Neither the tag keys nor the tag values will be modified by this module. map(string) {} no tenant ID element _(Rarely used, not included by default)_. A customer identifier, indicating who this instance of a resource is for string \"\" no vpc_id vpc_id for the VPC to run the cluster. string n/a yes Outputs \u00b6 Name Description aurora_arn Amazon Resource Name (ARN) of cluster aurora_cluster_identifier Cluster Identifier aurora_endpoint The DNS address of the RDS instance aurora_master_host DB Master hostname aurora_master_username Username for the master DB user aurora_name Database name aurora_reader_endpoint A read-only endpoint for the Aurora cluster, automatically load-balanced across replicas aurora_replicas_host Replicas hostname rds_instance_arn The RDS Instance AWS ARN. rds_instance_endpoint The DNS address to the RDS Instance. rds_instance_hostname Hostname of the RDS Instance. rds_instance_id The RDS Instance AWS ID. rds_instance_kms_arn RDS KMS Key ARN rds_instance_kms_id Output RDS KMS Key ID if the var.rds_kms_key_arn_override is \"\" rds_instance_resource_id The RDS Instance AWS resource ID. Development \u00b6 Prerequisites \u00b6 terraform terraform-docs pre-commit golang golint Configurations \u00b6 Configure pre-commit hooks 1 pre-commit install Tests \u00b6 Tests are available in test directory Configure the dependencies 1 2 3 cd test go mod init github.com/sourcefuse/terraform-aws-ref-arch-db go get github.com/gruntwork-io/terratest/modules/terraform Now execute the test 1 2 cd test/ go test Authors \u00b6 This project is authored by: SourceFuse","title":"terraform-aws-ref-arch-db"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#terraform-aws-ref-arch-db","text":"This project was generated by generator-tf-module","title":"terraform-aws-ref-arch-db"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#overview","text":"SourceFuse AWS Reference Architecture (ARC) Terraform module for managing Aurora and RDS instances.","title":"Overview"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#usage","text":"To see a full example, check out the main.tf file in the example folder. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 module \"aurora\" { source = \"git::https://github.com/sourcefuse/terraform-aws-ref-arch-db\" environment = \"dev\" namespace = \"arc\" vpc_id = \"vpc-000111222333444\" aurora_cluster_enabled = true aurora_cluster_name = \"aurora-example\" enhanced_monitoring_name = \"aurora-example-enhanced-monitoring\" aurora_db_admin_username = \"example_db_admin\" aurora_db_name = \"example\" aurora_allow_major_version_upgrade = true aurora_auto_minor_version_upgrade = true aurora_cluster_size = 0 aurora_instance_type = \"db.serverless\" aurora_subnets = [ \"subnet-0001112223334441\" , \"subnet-0001112223334442\" , ] aurora_security_groups = [ \"sg-0001112223334441\" , \"sg-0001112223334442\" ] aurora_allowed_cidr_blocks = [ \"10.0.0.0/16\" ] aurora_serverlessv2_scaling_configuration = { max_capacity = 16 min_capacity = 2 } }","title":"Usage"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#requirements","text":"Name Version terraform >= 1.2 aws ~> 4.44 null ~> 3.1.1 random ~> 3.4.0","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#providers","text":"Name Version aws 4.57.0 random 3.4.3","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#modules","text":"Name Source Version aurora_cluster git:: https://github.com/cloudposse/terraform-aws-rds-cluster.git 1.3.2 db_management git:: https://github.com/cloudposse/terraform-aws-s3-bucket 3.0.0 rds_instance git:: https://github.com/cloudposse/terraform-aws-rds 0.40.0 this cloudposse/label/null 0.25.0","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#resources","text":"Name Type aws_db_option_group.this resource aws_iam_policy.option_group resource aws_iam_role.enhanced_monitoring resource aws_iam_role.option_group resource aws_iam_role_policy_attachment.enhanced_monitoring resource aws_iam_role_policy_attachment.option_group resource aws_kms_alias.aurora_cluster_kms_key resource aws_kms_alias.rds_db_kms_key resource aws_kms_key.aurora_cluster_kms_key resource aws_kms_key.rds_db_kms_key resource aws_ssm_parameter.this resource random_password.aurora_db_admin_password resource random_password.rds_db_admin_password resource aws_iam_policy_document.enhanced_monitoring data source","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#inputs","text":"Name Description Type Default Required account_id Account ID where the resources will be deployed to. This is required if enable_custom_option_group is set to true . string \"\" no additional_tag_map Additional key-value pairs to add to each map in tags_as_list_of_maps . Not added to tags or id . This is for some rare cases where resources want additional configuration of tags and therefore take a list of maps with tag key, value, and additional configuration. map(string) {} no attributes ID element. Additional attributes (e.g. workers or cluster ) to add to id , in the order they appear in the list. New attributes are appended to the end of the list. The elements of the list are joined by the delimiter and treated as a single ID element. list(string) [] no aurora_allow_major_version_upgrade Enable to allow major engine version upgrades when changing engine versions. Defaults to false. bool false no aurora_allowed_cidr_blocks List of CIDR blocks allowed to access the cluster list(string) [] no aurora_auto_minor_version_upgrade Indicates that minor engine upgrades will be applied automatically to the DB instance during the maintenance window bool true no aurora_cluster_enabled Enable creation of an Aurora Cluster bool false no aurora_cluster_family The family of the DB cluster parameter group string \"aurora-postgresql14\" no aurora_cluster_name Database name (default is not to create a database) string \"\" no aurora_cluster_size Number of DB instances to create in the cluster number 0 no aurora_db_admin_password Password of the DB admin string \"\" no aurora_db_admin_username Name of the default DB admin user role string \"\" no aurora_db_name Database name. string \"auroradb\" no aurora_engine The name of the database engine to be used for this DB cluster. Valid values: aurora , aurora-mysql , aurora-postgresql string \"aurora-postgresql\" no aurora_engine_mode The database engine mode. Valid values: parallelquery , provisioned , serverless string \"provisioned\" no aurora_engine_version The version of the database engine tocl use. See aws rds describe-db-engine-versions string \"14.5\" no aurora_instance_type Instance type to use string \"db.serverless\" no aurora_scaling_configuration List of nested attributes with scaling properties. Only valid when engine_mode is set to serverless list(object({ auto_pause = bool max_capacity = number min_capacity = number seconds_until_auto_pause = number timeout_action = string })) [] no aurora_security_groups List of security group IDs to be allowed to connect to the DB instance list(string) [] no aurora_serverlessv2_scaling_configuration serverlessv2 scaling properties object({ min_capacity = number max_capacity = number }) null no aurora_subnets Subnets for the cluster to run in. list(string) [] no context Single object for setting entire context at once. See description of individual variables for details. Leave string and numeric variables as null to use default value. Individual variable settings (non-null) override settings in context object, except for attributes, tags, and additional_tag_map, which are merged. any { \"additional_tag_map\": {}, \"attributes\": [], \"delimiter\": null, \"descriptor_formats\": {}, \"enabled\": true, \"environment\": null, \"id_length_limit\": null, \"label_key_case\": null, \"label_order\": [], \"label_value_case\": null, \"labels_as_tags\": [ \"unset\" ], \"name\": null, \"namespace\": null, \"regex_replace_chars\": null, \"stage\": null, \"tags\": {}, \"tenant\": null } no deletion_protection Protect the instance from being deleted bool false no deletion_window_in_days n/a number 10 no delimiter Delimiter to be used between ID elements. Defaults to - (hyphen). Set to \"\" to use no delimiter at all. string null no descriptor_formats Describe additional descriptors to be output in the descriptors output map. Map of maps. Keys are names of descriptors. Values are maps of the form {<br> format = string<br> labels = list(string)<br>} (Type is any so the map values can later be enhanced to provide additional options.) format is a Terraform format string to be passed to the format() function. labels is a list of labels, in order, to pass to format() function. Label values will be normalized before being passed to format() so they will be identical to how they appear in id . Default is {} ( descriptors output will be empty). any {} no enable_custom_option_group Enable the custom Option Group for restoring backups via S3 bool false no enable_key_rotation n/a bool true no enabled Set to false to prevent the module from creating any resources bool null no enhanced_monitoring_arn ARN to the enhanced monitoring policy string \"arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole\" no enhanced_monitoring_name Name to assign the enhanced monitoring resources. string n/a yes environment ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT' string n/a yes id_length_limit Limit id to this many characters (minimum 6). Set to 0 for unlimited length. Set to null for keep the existing setting, which defaults to 0 . Does not affect id_full . number null no label_key_case Controls the letter case of the tags keys (label names) for tags generated by this module. Does not affect keys of tags passed in via the tags input. Possible values: lower , title , upper . Default value: title . string null no label_order The order in which the labels (ID elements) appear in the id . Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"]. You can omit any of the 6 labels (\"tenant\" is the 6 th ), but at least one must be present. list(string) null no label_value_case Controls the letter case of ID elements (labels) as included in id , set as tag values, and output by this module individually. Does not affect values of tags passed in via the tags input. Possible values: lower , title , upper and none (no transformation). Set this to title and set delimiter to \"\" to yield Pascal Case IDs. Default value: lower . string null no labels_as_tags Set of labels (ID elements) to include as tags in the tags output. Default is to include all labels. Tags with empty values will not be included in the tags output. Set to [] to suppress all generated tags. Notes: The value of the name tag, if included, will be the id , not the name . Unlike other null-label inputs, the initial setting of labels_as_tags cannot be changed in later chained modules. Attempts to change it will be silently ignored. set(string) [ \"default\" ] no name ID element. Usually the component or solution name, e.g. 'app' or 'jenkins'. This is the only ID element not also included as a tag . The \"name\" tag is set to the full id string. There is no tag with the value of the name input. string null no namespace ID element. Usually an abbreviation of your organization name, e.g. 'eg' or 'cp', to help ensure generated IDs are globally unique string n/a yes rds_instance_allocated_storage The allocated storage in GBs. Required unless a snapshot_identifier or replicate_source_db is provided. number 20 no rds_instance_allow_major_version_upgrade Allow major version upgrade bool false no rds_instance_allowed_cidr_blocks The whitelisted CIDRs which to allow ingress traffic to the DB instance list(string) [] no rds_instance_apply_immediately Specifies whether any database modifications are applied immediately, or during the next maintenance window bool true no rds_instance_auto_minor_version_upgrade Allow automated minor version upgrade (e.g. from Postgres 9.5.3 to Postgres 9.5.4) bool true no rds_instance_backup_retention_period Backup retention period in days. Must be > 0 to enable backups number 0 no rds_instance_backup_window When AWS can perform DB snapshots, can't overlap with maintenance window string \"22:00-03:00\" no rds_instance_ca_cert_identifier The identifier of the CA certificate for the DB instance string null no rds_instance_copy_tags_to_snapshot Copy tags from DB to a snapshot bool true no rds_instance_database_name The name of the database to create when the DB instance is created string null no rds_instance_database_password Password for the primary DB user. Required unless a snapshot_identifier or replicate_source_db is provided. string \"\" no rds_instance_database_port Database port (_e.g._ 3306 for MySQL). Used in the DB Security Group to allow access to the DB instance from the provided security_group_ids number 5432 no rds_instance_database_user The name of the database to create when the DB instance is created string \"admin\" no rds_instance_db_options A list of DB options to apply with an option group. Depends on DB engine list(object({ db_security_group_memberships = list(string) option_name = string port = number version = string vpc_security_group_memberships = list(string) option_settings = list(object({ name = string value = string })) })) [] no rds_instance_db_parameter A list of DB parameters to apply. Note that parameters may differ from a DB family to another list(object({ apply_method = string name = string value = string })) [] no rds_instance_db_parameter_group The DB parameter group family name. The value depends on DB engine used. See DBParameterGroupFamily for instructions on how to retrieve applicable value. string \"postgres14\" no rds_instance_dns_zone_id The ID of the DNS Zone in Route53 where a new DNS record will be created for the DB host name string \"\" no rds_instance_enabled Enable creation of an RDS instance bool false no rds_instance_engine Database engine type. Required unless a snapshot_identifier or replicate_source_db is provided. For supported values, see the Engine parameter in API action CreateDBInstance. string \"postgres\" no rds_instance_engine_version Database engine version, depends on engine type. Required unless a snapshot_identifier or replicate_source_db is provided. string \"14.3\" no rds_instance_host_name The DB host name created in Route53 string \"db\" no rds_instance_instance_class Class of RDS instance string \"db.t2.medium\" no rds_instance_license_model License model for this DB. Optional, but required for some DB Engines. Valid values: license-included | bring-your-own-license | general-public-license string \"\" no rds_instance_maintenance_window The window to perform maintenance in. Syntax: 'ddd:hh24:mi-ddd:hh24:mi' UTC string \"Mon:03:00-Mon:04:00\" no rds_instance_major_engine_version major_engine_version Database MAJOR engine version, depends on engine type string \"14\" no rds_instance_multi_az Set to true if multi AZ deployment must be supported bool false no rds_instance_name RDS Instance name string \"\" no rds_instance_option_group_name Name of the DB option group to associate string \"\" no rds_instance_publicly_accessible Determines if database can be publicly available (NOT recommended) bool false no rds_instance_security_group_ids The IDs of the security groups from which to allow ingress traffic to the DB instance list(string) [] no rds_instance_skip_final_snapshot If true (default), no snapshot will be made before deleting DB bool true no rds_instance_snapshot_identifier Snapshot identifier e.g: rds:production-2019-06-26-06-05. If specified, the module create cluster from the snapshot string null no rds_instance_storage_encrypted Specifies whether the DB instance is encrypted. The default is false if not specified bool true no rds_instance_storage_type One of 'standard' (magnetic), 'gp2' (general purpose SSD), or 'io1' (provisioned IOPS SSD) string \"gp2\" no rds_instance_subnet_ids List of subnet IDs for the DB. DB instance will be created in the VPC associated with the DB subnet group provisioned using the subnet IDs. Specify one of subnet_ids, db_subnet_group_name or availability_zone list(string) [] no rds_kms_key_arn_override Override the default created KMS key to encrypt storage string \"\" no rds_kms_key_id_override Override the default created KMS key ID to encrypt storage string \"\" no regex_replace_chars Terraform regular expression (regex) string. Characters matching the regex will be removed from the ID elements. If not set, \"/[^a-zA-Z0-9-]/\" is used to remove all characters other than hyphens, letters and digits. string null no region Region which the resource is deployed to string \"us-east-1\" no s3_kms_alias_override Override the KMS key alias for the S3 bucket. Default is set to AWS Managed KMS alias. string \"\" no stage ID element. Usually used to indicate role, e.g. 'prod', 'staging', 'source', 'build', 'test', 'deploy', 'release' string null no tags Additional tags (e.g. {'BusinessUnit': 'XYZ'} ). Neither the tag keys nor the tag values will be modified by this module. map(string) {} no tenant ID element _(Rarely used, not included by default)_. A customer identifier, indicating who this instance of a resource is for string \"\" no vpc_id vpc_id for the VPC to run the cluster. string n/a yes","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#outputs","text":"Name Description aurora_arn Amazon Resource Name (ARN) of cluster aurora_cluster_identifier Cluster Identifier aurora_endpoint The DNS address of the RDS instance aurora_master_host DB Master hostname aurora_master_username Username for the master DB user aurora_name Database name aurora_reader_endpoint A read-only endpoint for the Aurora cluster, automatically load-balanced across replicas aurora_replicas_host Replicas hostname rds_instance_arn The RDS Instance AWS ARN. rds_instance_endpoint The DNS address to the RDS Instance. rds_instance_hostname Hostname of the RDS Instance. rds_instance_id The RDS Instance AWS ID. rds_instance_kms_arn RDS KMS Key ARN rds_instance_kms_id Output RDS KMS Key ID if the var.rds_kms_key_arn_override is \"\" rds_instance_resource_id The RDS Instance AWS resource ID.","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#development","text":"","title":"Development"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#prerequisites","text":"terraform terraform-docs pre-commit golang golint","title":"Prerequisites"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#configurations","text":"Configure pre-commit hooks 1 pre-commit install","title":"Configurations"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#tests","text":"Tests are available in test directory Configure the dependencies 1 2 3 cd test go mod init github.com/sourcefuse/terraform-aws-ref-arch-db go get github.com/gruntwork-io/terratest/modules/terraform Now execute the test 1 2 cd test/ go test","title":"Tests"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-db/#authors","text":"This project is authored by: SourceFuse","title":"Authors"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/","text":"terraform-aws-ref-arch-eks \u00b6 Overview \u00b6 AWS Terraform module for the EKS implementation of the SourceFuse reference architecture. Usage \u00b6 1 2 3 module \"terraform-aws-ref-arch-eks\" { source = \"git::ssh://\" } Requirements \u00b6 Name Version terraform >= 1.0.8 aws >= 4.26.0 helm >= 2.0.0 kubectl >= 1.14.0 kubernetes >= 2.0.0 null >= 3.1.0 Providers \u00b6 Name Version aws 4.38.0 helm 2.7.1 kubernetes 2.15.0 Modules \u00b6 Name Source Version cluster_autoscaler_helm git@github.com :lablabs/terraform-aws-eks-cluster-autoscaler v2.0.0 core_apps ./core-apps n/a eks_cluster cloudposse/eks-cluster/aws 2.5.0 eks_fargate_profile cloudposse/eks-fargate-profile/aws 1.1.0 eks_node_group cloudposse/eks-node-group/aws 2.6.0 label cloudposse/label/null 0.25.0 this cloudposse/label/null 0.25.0 Resources \u00b6 Name Type helm_release.csi_driver resource kubernetes_namespace.default_namespace resource aws_subnets.private data source aws_subnets.public data source aws_vpc.vpc data source Inputs \u00b6 Name Description Type Default Required additional_tag_map Additional key-value pairs to add to each map in tags_as_list_of_maps . Not added to tags or id . This is for some rare cases where resources want additional configuration of tags and therefore take a list of maps with tag key, value, and additional configuration. map(string) {} no addons Manages aws_eks_addon resources. list(object({ addon_name = string addon_version = string resolve_conflicts = string service_account_role_arn = string })) [] no allowed_security_groups List of Security Group IDs to be allowed to connect to the EKS cluster list(string) [] no apply_config_map_aws_auth Whether to apply the ConfigMap to allow worker nodes to join the EKS cluster and allow additional users, accounts and roles to acces the cluster bool true no attributes ID element. Additional attributes (e.g. workers or cluster ) to add to id , in the order they appear in the list. New attributes are appended to the end of the list. The elements of the list are joined by the delimiter and treated as a single ID element. list(string) [] no cluster_encryption_config_enabled Set to true to enable Cluster Encryption Configuration bool true no cluster_encryption_config_kms_key_deletion_window_in_days Cluster Encryption Config KMS Key Resource argument - key deletion windows in days post destruction number 10 no cluster_encryption_config_kms_key_enable_key_rotation Cluster Encryption Config KMS Key Resource argument - enable kms key rotation bool true no cluster_encryption_config_kms_key_id KMS Key ID to use for cluster encryption config string \"\" no cluster_encryption_config_kms_key_policy Cluster Encryption Config KMS Key Resource argument - key policy string null no cluster_encryption_config_resources Cluster Encryption Config Resources to encrypt, e.g. ['secrets'] list(any) [ \"secrets\" ] no cluster_log_retention_period Number of days to retain cluster logs. Requires enabled_cluster_log_types to be set. See https://docs.aws.amazon.com/en_us/eks/latest/userguide/control-plane-logs.html . number 0 no context Single object for setting entire context at once. See description of individual variables for details. Leave string and numeric variables as null to use default value. Individual variable settings (non-null) override settings in context object, except for attributes, tags, and additional_tag_map, which are merged. any { \"additional_tag_map\": {}, \"attributes\": [], \"delimiter\": null, \"descriptor_formats\": {}, \"enabled\": true, \"environment\": null, \"id_length_limit\": null, \"label_key_case\": null, \"label_order\": [], \"label_value_case\": null, \"labels_as_tags\": [ \"unset\" ], \"name\": null, \"namespace\": null, \"regex_replace_chars\": null, \"stage\": null, \"tags\": {}, \"tenant\": null } no csi_driver_enabled The Secrets Store CSI Driver secrets-store.csi.k8s.io allows Kubernetes to mount multiple secrets, keys, and certs stored in enterprise-grade external secrets stores into their pods as a volume. bool true no delimiter Delimiter to be used between ID elements. Defaults to - (hyphen). Set to \"\" to use no delimiter at all. string null no descriptor_formats Describe additional descriptors to be output in the descriptors output map. Map of maps. Keys are names of descriptors. Values are maps of the form {<br> format = string<br> labels = list(string)<br>} (Type is any so the map values can later be enhanced to provide additional options.) format is a Terraform format string to be passed to the format() function. labels is a list of labels, in order, to pass to format() function. Label values will be normalized before being passed to format() so they will be identical to how they appear in id . Default is {} ( descriptors output will be empty). any {} no desired_size Desired number of worker nodes number n/a yes enabled Set to false to prevent the module from creating any resources bool false no enabled_cluster_log_types A list of the desired control plane logging to enable. For more information, see https://docs.aws.amazon.com/en_us/eks/latest/userguide/control-plane-logs.html . Possible values [ api , audit , authenticator , controllerManager , scheduler ] list(string) [ \"api\", \"audit\", \"authenticator\", \"controllerManager\", \"scheduler\" ] no environment ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT' string null no id_length_limit Limit id to this many characters (minimum 6). Set to 0 for unlimited length. Set to null for keep the existing setting, which defaults to 0 . Does not affect id_full . number null no instance_types Set of instance types associated with the EKS Node Group. Defaults to [\"t3.medium\"]. Terraform will only perform drift detection if a configuration value is provided list(string) n/a yes kube_data_auth_enabled If true , use an aws_eks_cluster_auth data source to authenticate to the EKS cluster. Disabled by kubeconfig_path_enabled or kube_exec_auth_enabled . bool true no kube_exec_auth_enabled If true , use the Kubernetes provider exec feature to execute aws eks get-token to authenticate to the EKS cluster. Disabled by kubeconfig_path_enabled , overrides kube_data_auth_enabled . bool false no kubernetes_config_map_ignore_role_changes Set to true to ignore IAM role changes in the Kubernetes Auth ConfigMap bool false no kubernetes_labels Key-value mapping of Kubernetes labels. Only labels that are applied with the EKS API are managed by this argument. Other Kubernetes labels applied to the EKS Node Group will not be managed map(string) {} no kubernetes_namespace Kubernetes namespace for selection string n/a yes kubernetes_version Desired Kubernetes master version. If you do not specify a value, the latest available version is used string \"1.21\" no label_key_case Controls the letter case of the tags keys (label names) for tags generated by this module. Does not affect keys of tags passed in via the tags input. Possible values: lower , title , upper . Default value: title . string null no label_order The order in which the labels (ID elements) appear in the id . Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"]. You can omit any of the 6 labels (\"tenant\" is the 6 th ), but at least one must be present. list(string) null no label_value_case Controls the letter case of ID elements (labels) as included in id , set as tag values, and output by this module individually. Does not affect values of tags passed in via the tags input. Possible values: lower , title , upper and none (no transformation). Set this to title and set delimiter to \"\" to yield Pascal Case IDs. Default value: lower . string null no labels_as_tags Set of labels (ID elements) to include as tags in the tags output. Default is to include all labels. Tags with empty values will not be included in the tags output. Set to [] to suppress all generated tags. Notes: The value of the name tag, if included, will be the id , not the name . Unlike other null-label inputs, the initial setting of labels_as_tags cannot be changed in later chained modules. Attempts to change it will be silently ignored. set(string) [ \"default\" ] no local_exec_interpreter shell to use for local_exec list(string) [ \"/bin/sh\", \"-c\" ] no map_additional_iam_roles Additional IAM roles to add to config-map-aws-auth ConfigMap list(object({ rolearn = string username = string groups = list(string) })) n/a yes max_size The maximum size of the AutoScaling Group number n/a yes min_size The minimum size of the AutoScaling Group number n/a yes name ID element. Usually the component or solution name, e.g. 'app' or 'jenkins'. This is the only ID element not also included as a tag . The \"name\" tag is set to the full id string. There is no tag with the value of the name input. string null no namespace ID element. Usually an abbreviation of your organization name, e.g. 'eg' or 'cp', to help ensure generated IDs are globally unique string null no oidc_provider_enabled Create an IAM OIDC identity provider for the cluster, then you can create IAM roles to associate with a service account in the cluster, instead of using kiam or kube2iam . For more information, see https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html bool true no private_subnet_names Name tag of the private subnets used for data lookups list(string) n/a yes public_access_cidrs Specify the cidr blocks which will be able to access the eks public api endpoint list(string) [ \"0.0.0.0/0\" ] no public_subnet_names Name tag of the public subnets used for data lookups list(string) n/a yes regex_replace_chars Terraform regular expression (regex) string. Characters matching the regex will be removed from the ID elements. If not set, \"/[^a-zA-Z0-9-]/\" is used to remove all characters other than hyphens, letters and digits. string null no region AWS region string n/a yes stage ID element. Usually used to indicate role, e.g. 'prod', 'staging', 'source', 'build', 'test', 'deploy', 'release' string null no tags Additional tags (e.g. {'BusinessUnit': 'XYZ'} ). Neither the tag keys nor the tag values will be modified by this module. map(string) {} no tenant ID element _(Rarely used, not included by default)_. A customer identifier, indicating who this instance of a resource is for string null no vpc_name Name tag of the VPC used for data lookups string n/a yes Outputs \u00b6 Name Description eks_cluster_arn The Amazon Resource Name (ARN) of the cluster eks_cluster_ca_certificate CA certificate eks_cluster_endpoint The endpoint for the Kubernetes API server eks_cluster_id The name of the cluster eks_cluster_identity_oidc_issuer The OIDC Identity issuer for the cluster eks_cluster_managed_security_group_id Security Group ID that was created by EKS for the cluster. EKS creates a Security Group and applies it to ENI that is attached to EKS Control Plane master nodes and to any managed workloads eks_cluster_security_group_arn ARN of the EKS cluster Security Group eks_cluster_security_group_id ID of the EKS cluster Security Group eks_cluster_security_group_name Name of the EKS cluster Security Group eks_cluster_version The Kubernetes server version of the cluster eks_node_group_arn Amazon Resource Name (ARN) of the EKS Node Group eks_node_group_id EKS Cluster name and EKS Node Group name separated by a colon eks_node_group_resources List of objects containing information about underlying resources of the EKS Node Group eks_node_group_role_arn ARN of the worker nodes IAM role eks_node_group_role_name Name of the worker nodes IAM role eks_node_group_status Status of the EKS Node Group eks_oidc_issuer_arn EKS Cluster OIDC issuer Kubernetes dashboard \u00b6 To view the dashboard, run the following commands: 1 2 3 aws eks update-kubeconfig --name refarch-dev-primary-k8s-cluster --region us-east-1 kubectl -n kube-system describe secret $( kubectl -n kube-system get secret | grep eks-dashboard-viewer | awk '{print $1}' ) #Copy the token from the output kubectl proxy Then navigate to: 1 http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login and use the copied token to login Development \u00b6 Prerequisites \u00b6 terraform terraform-docs pre-commit golang golint Configurations \u00b6 Configure pre-commit hooks 1 pre-commit install Configure golang deps for tests 1 2 > go get github.com/gruntwork-io/terratest/modules/terraform > go get github.com/stretchr/testify/assert Tests \u00b6 Tests are available in test directory In the test directory, run the below command 1 go test Authors \u00b6 This project is authored by below people SourceFuse This project was generated by generator-tf-module","title":"terraform-aws-ref-arch-eks"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#terraform-aws-ref-arch-eks","text":"","title":"terraform-aws-ref-arch-eks"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#overview","text":"AWS Terraform module for the EKS implementation of the SourceFuse reference architecture.","title":"Overview"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#usage","text":"1 2 3 module \"terraform-aws-ref-arch-eks\" { source = \"git::ssh://\" }","title":"Usage"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#requirements","text":"Name Version terraform >= 1.0.8 aws >= 4.26.0 helm >= 2.0.0 kubectl >= 1.14.0 kubernetes >= 2.0.0 null >= 3.1.0","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#providers","text":"Name Version aws 4.38.0 helm 2.7.1 kubernetes 2.15.0","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#modules","text":"Name Source Version cluster_autoscaler_helm git@github.com :lablabs/terraform-aws-eks-cluster-autoscaler v2.0.0 core_apps ./core-apps n/a eks_cluster cloudposse/eks-cluster/aws 2.5.0 eks_fargate_profile cloudposse/eks-fargate-profile/aws 1.1.0 eks_node_group cloudposse/eks-node-group/aws 2.6.0 label cloudposse/label/null 0.25.0 this cloudposse/label/null 0.25.0","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#resources","text":"Name Type helm_release.csi_driver resource kubernetes_namespace.default_namespace resource aws_subnets.private data source aws_subnets.public data source aws_vpc.vpc data source","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#inputs","text":"Name Description Type Default Required additional_tag_map Additional key-value pairs to add to each map in tags_as_list_of_maps . Not added to tags or id . This is for some rare cases where resources want additional configuration of tags and therefore take a list of maps with tag key, value, and additional configuration. map(string) {} no addons Manages aws_eks_addon resources. list(object({ addon_name = string addon_version = string resolve_conflicts = string service_account_role_arn = string })) [] no allowed_security_groups List of Security Group IDs to be allowed to connect to the EKS cluster list(string) [] no apply_config_map_aws_auth Whether to apply the ConfigMap to allow worker nodes to join the EKS cluster and allow additional users, accounts and roles to acces the cluster bool true no attributes ID element. Additional attributes (e.g. workers or cluster ) to add to id , in the order they appear in the list. New attributes are appended to the end of the list. The elements of the list are joined by the delimiter and treated as a single ID element. list(string) [] no cluster_encryption_config_enabled Set to true to enable Cluster Encryption Configuration bool true no cluster_encryption_config_kms_key_deletion_window_in_days Cluster Encryption Config KMS Key Resource argument - key deletion windows in days post destruction number 10 no cluster_encryption_config_kms_key_enable_key_rotation Cluster Encryption Config KMS Key Resource argument - enable kms key rotation bool true no cluster_encryption_config_kms_key_id KMS Key ID to use for cluster encryption config string \"\" no cluster_encryption_config_kms_key_policy Cluster Encryption Config KMS Key Resource argument - key policy string null no cluster_encryption_config_resources Cluster Encryption Config Resources to encrypt, e.g. ['secrets'] list(any) [ \"secrets\" ] no cluster_log_retention_period Number of days to retain cluster logs. Requires enabled_cluster_log_types to be set. See https://docs.aws.amazon.com/en_us/eks/latest/userguide/control-plane-logs.html . number 0 no context Single object for setting entire context at once. See description of individual variables for details. Leave string and numeric variables as null to use default value. Individual variable settings (non-null) override settings in context object, except for attributes, tags, and additional_tag_map, which are merged. any { \"additional_tag_map\": {}, \"attributes\": [], \"delimiter\": null, \"descriptor_formats\": {}, \"enabled\": true, \"environment\": null, \"id_length_limit\": null, \"label_key_case\": null, \"label_order\": [], \"label_value_case\": null, \"labels_as_tags\": [ \"unset\" ], \"name\": null, \"namespace\": null, \"regex_replace_chars\": null, \"stage\": null, \"tags\": {}, \"tenant\": null } no csi_driver_enabled The Secrets Store CSI Driver secrets-store.csi.k8s.io allows Kubernetes to mount multiple secrets, keys, and certs stored in enterprise-grade external secrets stores into their pods as a volume. bool true no delimiter Delimiter to be used between ID elements. Defaults to - (hyphen). Set to \"\" to use no delimiter at all. string null no descriptor_formats Describe additional descriptors to be output in the descriptors output map. Map of maps. Keys are names of descriptors. Values are maps of the form {<br> format = string<br> labels = list(string)<br>} (Type is any so the map values can later be enhanced to provide additional options.) format is a Terraform format string to be passed to the format() function. labels is a list of labels, in order, to pass to format() function. Label values will be normalized before being passed to format() so they will be identical to how they appear in id . Default is {} ( descriptors output will be empty). any {} no desired_size Desired number of worker nodes number n/a yes enabled Set to false to prevent the module from creating any resources bool false no enabled_cluster_log_types A list of the desired control plane logging to enable. For more information, see https://docs.aws.amazon.com/en_us/eks/latest/userguide/control-plane-logs.html . Possible values [ api , audit , authenticator , controllerManager , scheduler ] list(string) [ \"api\", \"audit\", \"authenticator\", \"controllerManager\", \"scheduler\" ] no environment ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT' string null no id_length_limit Limit id to this many characters (minimum 6). Set to 0 for unlimited length. Set to null for keep the existing setting, which defaults to 0 . Does not affect id_full . number null no instance_types Set of instance types associated with the EKS Node Group. Defaults to [\"t3.medium\"]. Terraform will only perform drift detection if a configuration value is provided list(string) n/a yes kube_data_auth_enabled If true , use an aws_eks_cluster_auth data source to authenticate to the EKS cluster. Disabled by kubeconfig_path_enabled or kube_exec_auth_enabled . bool true no kube_exec_auth_enabled If true , use the Kubernetes provider exec feature to execute aws eks get-token to authenticate to the EKS cluster. Disabled by kubeconfig_path_enabled , overrides kube_data_auth_enabled . bool false no kubernetes_config_map_ignore_role_changes Set to true to ignore IAM role changes in the Kubernetes Auth ConfigMap bool false no kubernetes_labels Key-value mapping of Kubernetes labels. Only labels that are applied with the EKS API are managed by this argument. Other Kubernetes labels applied to the EKS Node Group will not be managed map(string) {} no kubernetes_namespace Kubernetes namespace for selection string n/a yes kubernetes_version Desired Kubernetes master version. If you do not specify a value, the latest available version is used string \"1.21\" no label_key_case Controls the letter case of the tags keys (label names) for tags generated by this module. Does not affect keys of tags passed in via the tags input. Possible values: lower , title , upper . Default value: title . string null no label_order The order in which the labels (ID elements) appear in the id . Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"]. You can omit any of the 6 labels (\"tenant\" is the 6 th ), but at least one must be present. list(string) null no label_value_case Controls the letter case of ID elements (labels) as included in id , set as tag values, and output by this module individually. Does not affect values of tags passed in via the tags input. Possible values: lower , title , upper and none (no transformation). Set this to title and set delimiter to \"\" to yield Pascal Case IDs. Default value: lower . string null no labels_as_tags Set of labels (ID elements) to include as tags in the tags output. Default is to include all labels. Tags with empty values will not be included in the tags output. Set to [] to suppress all generated tags. Notes: The value of the name tag, if included, will be the id , not the name . Unlike other null-label inputs, the initial setting of labels_as_tags cannot be changed in later chained modules. Attempts to change it will be silently ignored. set(string) [ \"default\" ] no local_exec_interpreter shell to use for local_exec list(string) [ \"/bin/sh\", \"-c\" ] no map_additional_iam_roles Additional IAM roles to add to config-map-aws-auth ConfigMap list(object({ rolearn = string username = string groups = list(string) })) n/a yes max_size The maximum size of the AutoScaling Group number n/a yes min_size The minimum size of the AutoScaling Group number n/a yes name ID element. Usually the component or solution name, e.g. 'app' or 'jenkins'. This is the only ID element not also included as a tag . The \"name\" tag is set to the full id string. There is no tag with the value of the name input. string null no namespace ID element. Usually an abbreviation of your organization name, e.g. 'eg' or 'cp', to help ensure generated IDs are globally unique string null no oidc_provider_enabled Create an IAM OIDC identity provider for the cluster, then you can create IAM roles to associate with a service account in the cluster, instead of using kiam or kube2iam . For more information, see https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html bool true no private_subnet_names Name tag of the private subnets used for data lookups list(string) n/a yes public_access_cidrs Specify the cidr blocks which will be able to access the eks public api endpoint list(string) [ \"0.0.0.0/0\" ] no public_subnet_names Name tag of the public subnets used for data lookups list(string) n/a yes regex_replace_chars Terraform regular expression (regex) string. Characters matching the regex will be removed from the ID elements. If not set, \"/[^a-zA-Z0-9-]/\" is used to remove all characters other than hyphens, letters and digits. string null no region AWS region string n/a yes stage ID element. Usually used to indicate role, e.g. 'prod', 'staging', 'source', 'build', 'test', 'deploy', 'release' string null no tags Additional tags (e.g. {'BusinessUnit': 'XYZ'} ). Neither the tag keys nor the tag values will be modified by this module. map(string) {} no tenant ID element _(Rarely used, not included by default)_. A customer identifier, indicating who this instance of a resource is for string null no vpc_name Name tag of the VPC used for data lookups string n/a yes","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#outputs","text":"Name Description eks_cluster_arn The Amazon Resource Name (ARN) of the cluster eks_cluster_ca_certificate CA certificate eks_cluster_endpoint The endpoint for the Kubernetes API server eks_cluster_id The name of the cluster eks_cluster_identity_oidc_issuer The OIDC Identity issuer for the cluster eks_cluster_managed_security_group_id Security Group ID that was created by EKS for the cluster. EKS creates a Security Group and applies it to ENI that is attached to EKS Control Plane master nodes and to any managed workloads eks_cluster_security_group_arn ARN of the EKS cluster Security Group eks_cluster_security_group_id ID of the EKS cluster Security Group eks_cluster_security_group_name Name of the EKS cluster Security Group eks_cluster_version The Kubernetes server version of the cluster eks_node_group_arn Amazon Resource Name (ARN) of the EKS Node Group eks_node_group_id EKS Cluster name and EKS Node Group name separated by a colon eks_node_group_resources List of objects containing information about underlying resources of the EKS Node Group eks_node_group_role_arn ARN of the worker nodes IAM role eks_node_group_role_name Name of the worker nodes IAM role eks_node_group_status Status of the EKS Node Group eks_oidc_issuer_arn EKS Cluster OIDC issuer","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#kubernetes-dashboard","text":"To view the dashboard, run the following commands: 1 2 3 aws eks update-kubeconfig --name refarch-dev-primary-k8s-cluster --region us-east-1 kubectl -n kube-system describe secret $( kubectl -n kube-system get secret | grep eks-dashboard-viewer | awk '{print $1}' ) #Copy the token from the output kubectl proxy Then navigate to: 1 http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login and use the copied token to login","title":"Kubernetes dashboard"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#development","text":"","title":"Development"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#prerequisites","text":"terraform terraform-docs pre-commit golang golint","title":"Prerequisites"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#configurations","text":"Configure pre-commit hooks 1 pre-commit install Configure golang deps for tests 1 2 > go get github.com/gruntwork-io/terratest/modules/terraform > go get github.com/stretchr/testify/assert","title":"Configurations"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#tests","text":"Tests are available in test directory In the test directory, run the below command 1 go test","title":"Tests"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-eks/#authors","text":"This project is authored by below people SourceFuse This project was generated by generator-tf-module","title":"Authors"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/","text":"terraform-aws-ref-arch-network \u00b6 Overview \u00b6 AWS Terraform module for the SourceFuse Reference Architecture. We consider this module to be a high order module that is composed of smaller modules underneath. In most cases, we use open source modules to create our high order modules. Please see the reference documentation below for more information about the modules used under the hood. Creates the following resources in a single region. VPC Multi-AZ private and public subnets Route tables, internet gateway, and NAT gateways Configurable VPN Gateway Configurable VPC Endpoints Usage \u00b6 See the example folder for a complete example. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 ################################################################ ## shared ################################################################ variable \"environment\" { type = string description = \"Name of the environment, i.e. dev, stage, prod\" default = \"dev\" } variable \"region\" { type = string description = \"AWS Region\" default = \"us-east-1\" } variable \"namespace\" { type = string description = \"Namespace of the project, i.e. refarch\" default = \"example\" } ################################################################ ## network ################################################################ variable \"availability_zones\" { type = list ( string ) description = \"List of availability zones to deploy resources in.\" default = [ \"us-east-1a\" , \"us-east-1b\" ] } variable \"vpc_ipv4_primary_cidr_block\" { type = string description = \"IPv4 CIDR block for the VPC to use.\" default = \"10.9.0.0/16\" } ################################################################ ## defaults ################################################################ terraform { required_version = \"~> 1.3\" required_providers { aws = { source = \"hashicorp/aws\" version = \"~> 4.9\" } } } provider \"aws\" { region = var.region } module \"tags\" { source = \"git::https://github.com/sourcefuse/terraform-aws-refarch-tags.git?ref=1.1.0\" environment = var.environment project = \"terraform-aws-ref-arch-network\" extra_tags = { Example = \"True\" } } ################################################################ ## network ################################################################ module \"network\" { source = \"../.\" namespace = var.namespace environment = var.environment availability_zones = var.availability_zones vpc_ipv4_primary_cidr_block = var.vpc_ipv4_primary_cidr_block tags = module.tags.tags } Requirements \u00b6 Name Version terraform ~> 1.3 aws >= 3.0.0, >= 4.0.0, >= 4.9.0 Providers \u00b6 Name Version aws 4.49.0 Modules \u00b6 Name Source Version private_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.15.0 public_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.15.0 vpc git:: https://github.com/cloudposse/terraform-aws-vpc.git 2.0.0 vpc_endpoints git:: https://github.com/cloudposse/terraform-aws-vpc.git//modules/vpc-endpoints 2.0.0 Resources \u00b6 Name Type aws_dx_connection.this resource aws_vpn_gateway.this resource Inputs \u00b6 Name Description Type Default Required assign_generated_ipv6_cidr_block When true , assign AWS generated IPv6 CIDR block to the VPC. Conflicts with ipv6_ipam_pool_id . bool true no availability_zones List of availability zones to deploy resources in. list(string) n/a yes default_network_acl_deny_all When true , manage the default network acl and remove all rules, disabling all ingress and egress. When false , do not mange the default networking acl, allowing it to be managed by another component. bool false no default_route_table_no_routes When true , manage the default route table and remove all routes, disabling all ingress and egress. When false , do not mange the default route table, allowing it to be managed by another component. Conflicts with Terraform resource aws_main_route_table_association . bool false no default_security_group_deny_all When true , manage the default security group and remove all rules, disabling all ingress and egress. When false , do not manage the default security group, allowing it to be managed by another component. bool true no direct_connect_bandwidth The bandwidth of the connection. Valid values for dedicated connections: 1Gbps, 10Gbps. Valid values for hosted connections: 50Mbps, 100Mbps, 200Mbps, 300Mbps, 400Mbps, 500Mbps, 1Gbps, 2Gbps, 5Gbps, 10Gbps and 100Gbps. Case sensitive. string \"10Gbps\" no direct_connect_enabled Enable direct connect. bool false no direct_connect_encryption_mode The connection MAC Security (MACsec) encryption mode. MAC Security (MACsec) is only available on dedicated connections. Valid values are no_encrypt, should_encrypt, and must_encrypt. string \"must_encrypt\" no direct_connect_location The location of AWS Direct Connect. Use aws directconnect describe-locations for the list of AWS Direct Connect locations. Use locationCode for the value. string null no direct_connect_provider The name of the service provider associated with the connection. string null no direct_connect_request_macsec Boolean value indicating whether you want the connection to support MAC Security (MACsec). MAC Security (MACsec) is only available on dedicated connections. Changing this value will cause the resource to be destroyed and re-created. See MACsec prerequisites for more information. bool false no direct_connect_skip_destroy et to true if you do not wish the connection to be deleted at destroy time, and instead just removed from the Terraform state. bool false no dns_hostnames_enabled Set true to enable DNS hostnames in the VPC bool true no dns_support_enabled Set true to enable DNS resolution in the VPC through the Amazon provided DNS server bool true no environment Name of the environment, i.e. dev, stage, prod string n/a yes gateway_vpc_endpoints A map of Gateway VPC Endpoints to provision into the VPC. This is a map of objects with the following attributes: - name : Short service name (either \"s3\" or \"dynamodb\") - policy = A policy (as JSON string) to attach to the endpoint that controls access to the service. May be null for full access. - route_table_ids : List of route tables to associate the gateway with. Routes to the gateway will be automatically added to these route tables. map(object({ name = string policy = string route_table_ids = list(string) })) {} no interface_vpc_endpoints A map of Interface VPC Endpoints to provision into the VPC. This is a map of objects with the following attributes: - name : Simple name of the service, like \"ec2\" or \"redshift\" - policy : A policy (as JSON string) to attach to the endpoint that controls access to the service. May be null for full access. - private_dns_enabled : Set true to associate a private hosted zone with the specified VPC - security_group_ids : The ID of one or more security groups to associate with the network interface. The first security group will replace the default association with the VPC's default security group. If you want to maintain the association with the default security group, either leave security_group_ids empty or include the default security group ID in the list. - subnet_ids : List of subnet in which to install the endpoints. map(object({ name = string policy = string private_dns_enabled = bool security_group_ids = list(string) subnet_ids = list(string) })) {} no internet_gateway_enabled Set true to create an Internet Gateway for the VPC bool true no ipv6_egress_only_internet_gateway_enabled Set true to create an IPv6 Egress-Only Internet Gateway for the VPC bool false no namespace Namespace of the project, i.e. refarch string n/a yes tags Default tags to apply to every resource map(string) n/a yes vpc_endpoints_enabled Enable VPC endpoints. bool false no vpc_ipv4_primary_cidr_block IPv4 CIDR block for the VPC to use. string n/a yes vpn_gateway_enabled Enable VPN Gateway. bool false no Outputs \u00b6 Name Description default_route_table_id The Default Route Table ID for the VPC main_route_table_id The Main Route Table ID for the VPC private_subnet_cidrs Private subnet CIDRs private_subnet_ids Private subnet IDs public_subnet_cidrs Public subnet CIDRs public_subnet_ids Public subnet IDs vpc_cidr The VPC CIDR block vpc_id The VPC ID Development \u00b6 Prerequisites \u00b6 terraform terraform-docs pre-commit golang golint Configurations \u00b6 Configure pre-commit hooks 1 pre-commit install Configure golang deps for tests 1 2 go get github.com/gruntwork-io/terratest/modules/terraform go get github.com/stretchr/testify/assert Tests \u00b6 Tests are available in test directory In the test directory, run the below command 1 go test -timeout 1800s Authors \u00b6 This project is authored by: - SourceFuse","title":"terraform-aws-ref-arch-network"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#terraform-aws-ref-arch-network","text":"","title":"terraform-aws-ref-arch-network"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#overview","text":"AWS Terraform module for the SourceFuse Reference Architecture. We consider this module to be a high order module that is composed of smaller modules underneath. In most cases, we use open source modules to create our high order modules. Please see the reference documentation below for more information about the modules used under the hood. Creates the following resources in a single region. VPC Multi-AZ private and public subnets Route tables, internet gateway, and NAT gateways Configurable VPN Gateway Configurable VPC Endpoints","title":"Overview"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#usage","text":"See the example folder for a complete example. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 ################################################################ ## shared ################################################################ variable \"environment\" { type = string description = \"Name of the environment, i.e. dev, stage, prod\" default = \"dev\" } variable \"region\" { type = string description = \"AWS Region\" default = \"us-east-1\" } variable \"namespace\" { type = string description = \"Namespace of the project, i.e. refarch\" default = \"example\" } ################################################################ ## network ################################################################ variable \"availability_zones\" { type = list ( string ) description = \"List of availability zones to deploy resources in.\" default = [ \"us-east-1a\" , \"us-east-1b\" ] } variable \"vpc_ipv4_primary_cidr_block\" { type = string description = \"IPv4 CIDR block for the VPC to use.\" default = \"10.9.0.0/16\" } ################################################################ ## defaults ################################################################ terraform { required_version = \"~> 1.3\" required_providers { aws = { source = \"hashicorp/aws\" version = \"~> 4.9\" } } } provider \"aws\" { region = var.region } module \"tags\" { source = \"git::https://github.com/sourcefuse/terraform-aws-refarch-tags.git?ref=1.1.0\" environment = var.environment project = \"terraform-aws-ref-arch-network\" extra_tags = { Example = \"True\" } } ################################################################ ## network ################################################################ module \"network\" { source = \"../.\" namespace = var.namespace environment = var.environment availability_zones = var.availability_zones vpc_ipv4_primary_cidr_block = var.vpc_ipv4_primary_cidr_block tags = module.tags.tags }","title":"Usage"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#requirements","text":"Name Version terraform ~> 1.3 aws >= 3.0.0, >= 4.0.0, >= 4.9.0","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#providers","text":"Name Version aws 4.49.0","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#modules","text":"Name Source Version private_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.15.0 public_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.15.0 vpc git:: https://github.com/cloudposse/terraform-aws-vpc.git 2.0.0 vpc_endpoints git:: https://github.com/cloudposse/terraform-aws-vpc.git//modules/vpc-endpoints 2.0.0","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#resources","text":"Name Type aws_dx_connection.this resource aws_vpn_gateway.this resource","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#inputs","text":"Name Description Type Default Required assign_generated_ipv6_cidr_block When true , assign AWS generated IPv6 CIDR block to the VPC. Conflicts with ipv6_ipam_pool_id . bool true no availability_zones List of availability zones to deploy resources in. list(string) n/a yes default_network_acl_deny_all When true , manage the default network acl and remove all rules, disabling all ingress and egress. When false , do not mange the default networking acl, allowing it to be managed by another component. bool false no default_route_table_no_routes When true , manage the default route table and remove all routes, disabling all ingress and egress. When false , do not mange the default route table, allowing it to be managed by another component. Conflicts with Terraform resource aws_main_route_table_association . bool false no default_security_group_deny_all When true , manage the default security group and remove all rules, disabling all ingress and egress. When false , do not manage the default security group, allowing it to be managed by another component. bool true no direct_connect_bandwidth The bandwidth of the connection. Valid values for dedicated connections: 1Gbps, 10Gbps. Valid values for hosted connections: 50Mbps, 100Mbps, 200Mbps, 300Mbps, 400Mbps, 500Mbps, 1Gbps, 2Gbps, 5Gbps, 10Gbps and 100Gbps. Case sensitive. string \"10Gbps\" no direct_connect_enabled Enable direct connect. bool false no direct_connect_encryption_mode The connection MAC Security (MACsec) encryption mode. MAC Security (MACsec) is only available on dedicated connections. Valid values are no_encrypt, should_encrypt, and must_encrypt. string \"must_encrypt\" no direct_connect_location The location of AWS Direct Connect. Use aws directconnect describe-locations for the list of AWS Direct Connect locations. Use locationCode for the value. string null no direct_connect_provider The name of the service provider associated with the connection. string null no direct_connect_request_macsec Boolean value indicating whether you want the connection to support MAC Security (MACsec). MAC Security (MACsec) is only available on dedicated connections. Changing this value will cause the resource to be destroyed and re-created. See MACsec prerequisites for more information. bool false no direct_connect_skip_destroy et to true if you do not wish the connection to be deleted at destroy time, and instead just removed from the Terraform state. bool false no dns_hostnames_enabled Set true to enable DNS hostnames in the VPC bool true no dns_support_enabled Set true to enable DNS resolution in the VPC through the Amazon provided DNS server bool true no environment Name of the environment, i.e. dev, stage, prod string n/a yes gateway_vpc_endpoints A map of Gateway VPC Endpoints to provision into the VPC. This is a map of objects with the following attributes: - name : Short service name (either \"s3\" or \"dynamodb\") - policy = A policy (as JSON string) to attach to the endpoint that controls access to the service. May be null for full access. - route_table_ids : List of route tables to associate the gateway with. Routes to the gateway will be automatically added to these route tables. map(object({ name = string policy = string route_table_ids = list(string) })) {} no interface_vpc_endpoints A map of Interface VPC Endpoints to provision into the VPC. This is a map of objects with the following attributes: - name : Simple name of the service, like \"ec2\" or \"redshift\" - policy : A policy (as JSON string) to attach to the endpoint that controls access to the service. May be null for full access. - private_dns_enabled : Set true to associate a private hosted zone with the specified VPC - security_group_ids : The ID of one or more security groups to associate with the network interface. The first security group will replace the default association with the VPC's default security group. If you want to maintain the association with the default security group, either leave security_group_ids empty or include the default security group ID in the list. - subnet_ids : List of subnet in which to install the endpoints. map(object({ name = string policy = string private_dns_enabled = bool security_group_ids = list(string) subnet_ids = list(string) })) {} no internet_gateway_enabled Set true to create an Internet Gateway for the VPC bool true no ipv6_egress_only_internet_gateway_enabled Set true to create an IPv6 Egress-Only Internet Gateway for the VPC bool false no namespace Namespace of the project, i.e. refarch string n/a yes tags Default tags to apply to every resource map(string) n/a yes vpc_endpoints_enabled Enable VPC endpoints. bool false no vpc_ipv4_primary_cidr_block IPv4 CIDR block for the VPC to use. string n/a yes vpn_gateway_enabled Enable VPN Gateway. bool false no","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#outputs","text":"Name Description default_route_table_id The Default Route Table ID for the VPC main_route_table_id The Main Route Table ID for the VPC private_subnet_cidrs Private subnet CIDRs private_subnet_ids Private subnet IDs public_subnet_cidrs Public subnet CIDRs public_subnet_ids Public subnet IDs vpc_cidr The VPC CIDR block vpc_id The VPC ID","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#development","text":"","title":"Development"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#prerequisites","text":"terraform terraform-docs pre-commit golang golint","title":"Prerequisites"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#configurations","text":"Configure pre-commit hooks 1 pre-commit install Configure golang deps for tests 1 2 go get github.com/gruntwork-io/terratest/modules/terraform go get github.com/stretchr/testify/assert","title":"Configurations"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#tests","text":"Tests are available in test directory In the test directory, run the below command 1 go test -timeout 1800s","title":"Tests"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/#authors","text":"This project is authored by: - SourceFuse","title":"Authors"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/example/","text":"Requirements \u00b6 No requirements. Providers \u00b6 Name Version aws 3.57.0 Modules \u00b6 Name Source Version aws_key_pair cloudposse/key-pair/aws 0.18.2 ec2_bastion git:: https://github.com/cloudposse/terraform-aws-ec2-bastion-server.git 0.27.0 private_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.14.1 public_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.14.1 this cloudposse/label/null 0.24.1 vpc git:: https://github.com/cloudposse/terraform-aws-vpc.git 0.27.0 Resources \u00b6 Name Type aws_security_group.db_sg resource aws_security_group.ecs_tasks_sg resource aws_security_group.eks_sg resource aws_security_group.standard_web_sg resource Inputs \u00b6 Name Description Type Default Required additional_tag_map Additional tags for appending to tags_as_list_of_maps. Not added to tags . map(string) {} no associate_public_ip_address Whether to associate public IP to the instance. bool true no attributes Additional attributes (e.g. 1 ) list(string) [] no availability_zones List of availability zones to deploy resources in. list(string) n/a yes context Single object for setting entire context at once. See description of individual variables for details. Leave string and numeric variables as null to use default value. Individual variable settings (non-null) override settings in context object, except for attributes, tags, and additional_tag_map, which are merged. any { \"additional_tag_map\": {}, \"attributes\": [], \"delimiter\": null, \"enabled\": true, \"environment\": null, \"id_length_limit\": null, \"label_key_case\": null, \"label_order\": [], \"label_value_case\": null, \"name\": null, \"namespace\": null, \"regex_replace_chars\": null, \"stage\": null, \"tags\": {} } no default_egress Default egress CIDR list(string) [ \"0.0.0.0/0\" ] no default_ingress Default ingress CIDR list(string) [ \"0.0.0.0/0\" ] no delimiter Delimiter to be used between namespace , environment , stage , name and attributes . Defaults to - (hyphen). Set to \"\" to use no delimiter at all. string null no enabled Set to false to prevent the module from creating any resources bool null no environment Name of the environment, i.e. dev, stage, prod string \"dev\" no generate_ssh_key Whether or not to generate an SSH key bool n/a yes id_length_limit Limit id to this many characters (minimum 6). Set to 0 for unlimited length. Set to null for default, which is 0 . Does not affect id_full . number null no instance_type Bastion instance type string \"t2.micro\" no label_key_case The letter case of label keys ( tag names) (i.e. name , namespace , environment , stage , attributes ) to use in tags . Possible values: lower , title , upper . Default value: title . string null no label_order The naming order of the id output and Name tag. Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"]. You can omit any of the 5 elements, but at least one must be present. list(string) null no label_value_case The letter case of output label values (also used in tags and id ). Possible values: lower , title , upper and none (no transformation). Default value: lower . string null no metadata_http_endpoint_enabled Whether the metadata service is available bool true no metadata_http_tokens_required Whether or not the metadata service requires session tokens, also referred to as Instance Metadata Service Version 2. bool false no name Solution name, e.g. 'app' or 'jenkins' string null no namespace Namespace of the project, i.e. refarch string \"refarch\" no profile AWS Config profile string \"sf_ref_arch\" no regex_replace_chars Regex to replace chars with empty string in namespace , environment , stage and name . If not set, \"/[^a-zA-Z0-9-]/\" is used to remove all characters other than hyphens, letters and digits. string null no region AWS Region string n/a yes root_block_device_encrypted Whether to encrypt the root block device bool false no root_block_device_volume_size The volume size (in GiB) to provision for the root block device. It cannot be smaller than the AMI it refers to. number 8 no security_groups List of Security Group IDs allowed to connect to the bastion host list(string) n/a yes ssh_key_path Save location for ssh public keys generated by the module string n/a yes stage Stage, e.g. 'prod', 'staging', 'dev', OR 'source', 'build', 'test', 'deploy', 'release' string null no tags Default tags to apply to every resource map(string) n/a yes user_data User data content list(string) [] no vpc_cidr_block CIDR block for the VPC to use. string n/a yes zone_id Route53 DNS Zone ID string \"\" no Outputs \u00b6 Name Description arn ARN of the instance id Disambiguated ID of the instance instance_id Instance ID key_name n/a name Instance name private_dns Private DNS of instance private_ip Private IP of the instance private_subnet_cidrs n/a public_dns Public DNS of instance (or DNS of EIP) public_ip Public IP of the instance (or EIP) public_key n/a public_subnet_cidrs n/a role Name of AWS IAM Role associated with the instance security_group_id Bastion host Security Group ID security_group_ids Security group IDs vpc_cidr n/a","title":"Index"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/example/#requirements","text":"No requirements.","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/example/#providers","text":"Name Version aws 3.57.0","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/example/#modules","text":"Name Source Version aws_key_pair cloudposse/key-pair/aws 0.18.2 ec2_bastion git:: https://github.com/cloudposse/terraform-aws-ec2-bastion-server.git 0.27.0 private_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.14.1 public_subnets git:: https://github.com/cloudposse/terraform-aws-multi-az-subnets.git 0.14.1 this cloudposse/label/null 0.24.1 vpc git:: https://github.com/cloudposse/terraform-aws-vpc.git 0.27.0","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/example/#resources","text":"Name Type aws_security_group.db_sg resource aws_security_group.ecs_tasks_sg resource aws_security_group.eks_sg resource aws_security_group.standard_web_sg resource","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/example/#inputs","text":"Name Description Type Default Required additional_tag_map Additional tags for appending to tags_as_list_of_maps. Not added to tags . map(string) {} no associate_public_ip_address Whether to associate public IP to the instance. bool true no attributes Additional attributes (e.g. 1 ) list(string) [] no availability_zones List of availability zones to deploy resources in. list(string) n/a yes context Single object for setting entire context at once. See description of individual variables for details. Leave string and numeric variables as null to use default value. Individual variable settings (non-null) override settings in context object, except for attributes, tags, and additional_tag_map, which are merged. any { \"additional_tag_map\": {}, \"attributes\": [], \"delimiter\": null, \"enabled\": true, \"environment\": null, \"id_length_limit\": null, \"label_key_case\": null, \"label_order\": [], \"label_value_case\": null, \"name\": null, \"namespace\": null, \"regex_replace_chars\": null, \"stage\": null, \"tags\": {} } no default_egress Default egress CIDR list(string) [ \"0.0.0.0/0\" ] no default_ingress Default ingress CIDR list(string) [ \"0.0.0.0/0\" ] no delimiter Delimiter to be used between namespace , environment , stage , name and attributes . Defaults to - (hyphen). Set to \"\" to use no delimiter at all. string null no enabled Set to false to prevent the module from creating any resources bool null no environment Name of the environment, i.e. dev, stage, prod string \"dev\" no generate_ssh_key Whether or not to generate an SSH key bool n/a yes id_length_limit Limit id to this many characters (minimum 6). Set to 0 for unlimited length. Set to null for default, which is 0 . Does not affect id_full . number null no instance_type Bastion instance type string \"t2.micro\" no label_key_case The letter case of label keys ( tag names) (i.e. name , namespace , environment , stage , attributes ) to use in tags . Possible values: lower , title , upper . Default value: title . string null no label_order The naming order of the id output and Name tag. Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"]. You can omit any of the 5 elements, but at least one must be present. list(string) null no label_value_case The letter case of output label values (also used in tags and id ). Possible values: lower , title , upper and none (no transformation). Default value: lower . string null no metadata_http_endpoint_enabled Whether the metadata service is available bool true no metadata_http_tokens_required Whether or not the metadata service requires session tokens, also referred to as Instance Metadata Service Version 2. bool false no name Solution name, e.g. 'app' or 'jenkins' string null no namespace Namespace of the project, i.e. refarch string \"refarch\" no profile AWS Config profile string \"sf_ref_arch\" no regex_replace_chars Regex to replace chars with empty string in namespace , environment , stage and name . If not set, \"/[^a-zA-Z0-9-]/\" is used to remove all characters other than hyphens, letters and digits. string null no region AWS Region string n/a yes root_block_device_encrypted Whether to encrypt the root block device bool false no root_block_device_volume_size The volume size (in GiB) to provision for the root block device. It cannot be smaller than the AMI it refers to. number 8 no security_groups List of Security Group IDs allowed to connect to the bastion host list(string) n/a yes ssh_key_path Save location for ssh public keys generated by the module string n/a yes stage Stage, e.g. 'prod', 'staging', 'dev', OR 'source', 'build', 'test', 'deploy', 'release' string null no tags Default tags to apply to every resource map(string) n/a yes user_data User data content list(string) [] no vpc_cidr_block CIDR block for the VPC to use. string n/a yes zone_id Route53 DNS Zone ID string \"\" no","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-ref-arch-network/example/#outputs","text":"Name Description arn ARN of the instance id Disambiguated ID of the instance instance_id Instance ID key_name n/a name Instance name private_dns Private DNS of instance private_ip Private IP of the instance private_subnet_cidrs n/a public_dns Public DNS of instance (or DNS of EIP) public_ip Public IP of the instance (or EIP) public_key n/a public_subnet_cidrs n/a role Name of AWS IAM Role associated with the instance security_group_id Bastion host Security Group ID security_group_ids Security group IDs vpc_cidr n/a","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/","text":"terraform-aws-refarch-control-tower-aft \u00b6 Overview \u00b6 SourceFuse AWS Reference Architecture (ARC) Terraform module for managing Control Tower Account Factory Terraform. Usage \u00b6 To see a full example, check out the main.tf file in the example folder. 1 2 3 module \"aft\" { source = \"git::https://github.com/sourcefuse/terraform-aws-refarch-control-tower-aft.git\" } Requirements \u00b6 Name Version terraform >= 1.3 aws ~> 4.0 Providers \u00b6 No providers. Modules \u00b6 Name Source Version aft git:: https://github.com/aws-ia/terraform-aws-control_tower_account_factory 1.8.0 Resources \u00b6 No resources. Inputs \u00b6 Name Description Type Default Required account_customizations_repo Information on the git repo for managing the account customizations. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-account-customizations\" } no account_ids IDs to the accounts used for deploying the respective resources into object({ aft_management = string audit = string control_tower_management = string log_archive = string }) n/a yes account_provisioning_customizations_repo Information on the git repo for provisioning the account customizations. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-account-provisioning-customizations\" } no account_request_repo Information on the git repo for account requests. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-account-request\" } no aft_feature_cloudtrail_data_events Feature flag toggling CloudTrail data events on/off bool true no aft_feature_delete_default_vpcs_enabled Feature flag toggling deletion of default VPCs on/off bool true no aft_feature_enterprise_support Feature flag toggling Enterprise Support enrollment on/off bool false no aft_max_subnets Maximum number of subnets to create based off the provided VPC CIDR string \"4\" no aft_metrics_reporting Flag toggling reporting of operational metrics bool true no aft_vpc_cidr CIDR Block to allocate to the AFT VPC string n/a yes aft_vpc_endpoints Flag turning VPC endpoints on/off for AFT VPC bool true no cloudwatch_log_group_retention Amount of days to keep CloudWatch Log Groups for Lambda functions. 0 = Never Expire string \"0\" no control_tower_home_region The region from which this module will be executed. This MUST be the same region as Control Tower is deployed. string n/a yes github_enterprise_url GitHub enterprise URL, if GitHub Enterprise is being used string \"null\" no global_codebuild_timeout Codebuild build timeout number 60 no global_customizations_repo Information on the git repo for global customizations. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-global-customizations\" } no maximum_concurrent_customizations Maximum number of customizations/pipelines to run at once number 5 no terraform_api_endpoint API Endpoint for Terraform. Must be in the format of https://xxx.xxx . string \"https://app.terraform.io/api/v2/\" no terraform_backend_secondary_region AFT creates a backend for state tracking for its own state as well as OSS cases. The backend's primary region is the same as the AFT region, but this defines the secondary region to replicate to. string n/a yes terraform_distribution Terraform distribution being used for AFT - valid values are oss, tfc, or tfe string \"oss\" no terraform_org_name Organization name for Terraform Cloud or Enterprise string \"null\" no terraform_token Terraform token for Cloud or Enterprise string \"null\" no terraform_version Terraform version being used for AFT string \"1.3.6\" no vcs_provider Customer VCS Provider - valid inputs are codecommit, bitbucket, github, or githubenterprise string \"github\" no Outputs \u00b6 Name Description account_customizations_repo_branch VCS Account customizations repo branch account_customizations_repo_name VCS Account customizations repo name account_ids Map of account IDs for each account created. account_provisioning_customizations_repo_branch VCS Account provisioning customizations repo branch account_provisioning_customizations_repo_name VCS Account provisioning customizations repo name account_request_repo_branch VCS Account request repo branch. account_request_repo_name VCS Account request repo name. aft_feature_cloudtrail_data_events AFT feature \"CloudTrail data events\". aft_feature_delete_default_vpcs_enabled AFT feature \"delete default vpcs enabled\". aft_vpc_cidr AFT VPC assigned cidr. aft_vpc_private_subnet_cidrs AFT VPC private subnet 01 cidr. aft_vpc_public_subnet_cidrs AFT VPC private subnet 01 cidr. global_customizations_repo_branch Global customizations repo branch. global_customizations_repo_name Global customizations repo name. terraform_version Terraform version used for this configuration. tf_backend_secondary_region Terraform backend secondary region. vcs_provider VCS Provider where the repos are configure for the different accounts. Versioning \u00b6 This project uses a .version file at the root of the repo which the pipeline reads from and does a git tag. When you intend to commit to main , you will need to increment this version. Once the project is merged, the pipeline will kick off and tag the latest git commit. Development \u00b6 Prerequisites \u00b6 terraform terraform-docs pre-commit Configurations \u00b6 Configure pre-commit hooks 1 pre-commit install Authors \u00b6 This project is authored by: - SourceFuse","title":"terraform-aws-refarch-control-tower-aft"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#terraform-aws-refarch-control-tower-aft","text":"","title":"terraform-aws-refarch-control-tower-aft"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#overview","text":"SourceFuse AWS Reference Architecture (ARC) Terraform module for managing Control Tower Account Factory Terraform.","title":"Overview"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#usage","text":"To see a full example, check out the main.tf file in the example folder. 1 2 3 module \"aft\" { source = \"git::https://github.com/sourcefuse/terraform-aws-refarch-control-tower-aft.git\" }","title":"Usage"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#requirements","text":"Name Version terraform >= 1.3 aws ~> 4.0","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#providers","text":"No providers.","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#modules","text":"Name Source Version aft git:: https://github.com/aws-ia/terraform-aws-control_tower_account_factory 1.8.0","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#resources","text":"No resources.","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#inputs","text":"Name Description Type Default Required account_customizations_repo Information on the git repo for managing the account customizations. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-account-customizations\" } no account_ids IDs to the accounts used for deploying the respective resources into object({ aft_management = string audit = string control_tower_management = string log_archive = string }) n/a yes account_provisioning_customizations_repo Information on the git repo for provisioning the account customizations. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-account-provisioning-customizations\" } no account_request_repo Information on the git repo for account requests. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-account-request\" } no aft_feature_cloudtrail_data_events Feature flag toggling CloudTrail data events on/off bool true no aft_feature_delete_default_vpcs_enabled Feature flag toggling deletion of default VPCs on/off bool true no aft_feature_enterprise_support Feature flag toggling Enterprise Support enrollment on/off bool false no aft_max_subnets Maximum number of subnets to create based off the provided VPC CIDR string \"4\" no aft_metrics_reporting Flag toggling reporting of operational metrics bool true no aft_vpc_cidr CIDR Block to allocate to the AFT VPC string n/a yes aft_vpc_endpoints Flag turning VPC endpoints on/off for AFT VPC bool true no cloudwatch_log_group_retention Amount of days to keep CloudWatch Log Groups for Lambda functions. 0 = Never Expire string \"0\" no control_tower_home_region The region from which this module will be executed. This MUST be the same region as Control Tower is deployed. string n/a yes github_enterprise_url GitHub enterprise URL, if GitHub Enterprise is being used string \"null\" no global_codebuild_timeout Codebuild build timeout number 60 no global_customizations_repo Information on the git repo for global customizations. For non-CodeCommit repos, name should be in the format of org/repo. object({ name = string branch = string }) { \"branch\": \"main\", \"name\": \"sourcefuse/terraform-aws-refarch-aft-global-customizations\" } no maximum_concurrent_customizations Maximum number of customizations/pipelines to run at once number 5 no terraform_api_endpoint API Endpoint for Terraform. Must be in the format of https://xxx.xxx . string \"https://app.terraform.io/api/v2/\" no terraform_backend_secondary_region AFT creates a backend for state tracking for its own state as well as OSS cases. The backend's primary region is the same as the AFT region, but this defines the secondary region to replicate to. string n/a yes terraform_distribution Terraform distribution being used for AFT - valid values are oss, tfc, or tfe string \"oss\" no terraform_org_name Organization name for Terraform Cloud or Enterprise string \"null\" no terraform_token Terraform token for Cloud or Enterprise string \"null\" no terraform_version Terraform version being used for AFT string \"1.3.6\" no vcs_provider Customer VCS Provider - valid inputs are codecommit, bitbucket, github, or githubenterprise string \"github\" no","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#outputs","text":"Name Description account_customizations_repo_branch VCS Account customizations repo branch account_customizations_repo_name VCS Account customizations repo name account_ids Map of account IDs for each account created. account_provisioning_customizations_repo_branch VCS Account provisioning customizations repo branch account_provisioning_customizations_repo_name VCS Account provisioning customizations repo name account_request_repo_branch VCS Account request repo branch. account_request_repo_name VCS Account request repo name. aft_feature_cloudtrail_data_events AFT feature \"CloudTrail data events\". aft_feature_delete_default_vpcs_enabled AFT feature \"delete default vpcs enabled\". aft_vpc_cidr AFT VPC assigned cidr. aft_vpc_private_subnet_cidrs AFT VPC private subnet 01 cidr. aft_vpc_public_subnet_cidrs AFT VPC private subnet 01 cidr. global_customizations_repo_branch Global customizations repo branch. global_customizations_repo_name Global customizations repo name. terraform_version Terraform version used for this configuration. tf_backend_secondary_region Terraform backend secondary region. vcs_provider VCS Provider where the repos are configure for the different accounts.","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#versioning","text":"This project uses a .version file at the root of the repo which the pipeline reads from and does a git tag. When you intend to commit to main , you will need to increment this version. Once the project is merged, the pipeline will kick off and tag the latest git commit.","title":"Versioning"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#development","text":"","title":"Development"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#prerequisites","text":"terraform terraform-docs pre-commit","title":"Prerequisites"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#configurations","text":"Configure pre-commit hooks 1 pre-commit install","title":"Configurations"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-control-tower-aft/#authors","text":"This project is authored by: - SourceFuse","title":"Authors"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/","text":"terraform-aws-ref-arch-ecs \u00b6 Overview \u00b6 Terraform Module for AWS ECS by the SourceFuse ARC team. The module assumes that upstream dependencies, namely networking dependencies, are created upstream and the values are passed into this module via mechanisms such as Terraform data source queries. The module provisions ECS Cluster - we are focusing on the Fargate launch type, so we do not provision any underlying EC2 instances for the ECS launch type. Application Load Balancer Health Check Service - vanilla Nginx service that is used as the default route for the load balancer. The purpose of the health check service is to ensure that the core infrastructure, networking, security groups, etc. are configured correctly. Task execution IAM role - used by downstream services for task execution. Tags/SSM params - the module tags resources and outputs SSM params that can be used in data source lookups downstream for ECS services to reference to deploy into the cluster. Our approach to ECS Fargate clusters is to provision a cluster and allow downstream services to attach to it via convention based data source queries. Usage \u00b6 1 2 3 module \"ecs\" { source = \"git::https://github.com/sourcefuse/terraform-aws-refarch-ecs\" } Requirements \u00b6 Name Version terraform ~> 1.3 aws ~> 4.0 Providers \u00b6 Name Version aws 4.57.1 Modules \u00b6 Name Source Version acm git:: https://github.com/cloudposse/terraform-aws-acm-request-certificate 0.17.0 alb ./modules/alb n/a alb_sg git:: https://github.com/cloudposse/terraform-aws-security-group 2.0.0 ecs git:: https://github.com/terraform-aws-modules/terraform-aws-ecs v4.1.2 health_check ./modules/health-check n/a Resources \u00b6 Name Type aws_cloudwatch_log_group.this resource aws_iam_policy.secrets_manager_read_policy resource aws_iam_policy_attachment.execution resource aws_iam_policy_attachment.secrets_manager_read resource aws_iam_role.execution resource aws_lb_listener.http resource aws_lb_listener.https resource aws_service_discovery_private_dns_namespace.this resource aws_ssm_parameter.this resource aws_iam_policy_document.assume data source Inputs \u00b6 Name Description Type Default Required access_logs_enabled A boolean flag to enable/disable access_logs bool true no acm_domain_name Domain name the ACM Certificate belongs to string n/a yes acm_process_domain_validation_options Flag to enable/disable processing of the record to add to the DNS zone to complete certificate validation bool true no acm_process_domain_validation_record_ttl The TTL of the record to add to the DNS zone to complete certificate validation string \"300\" no acm_subject_alternative_names Subject alternative names for the ACM Certificate list(string) [] no additional_ssm_params Additional SSM Parameters you would like to add for your ECS configuration. The optional value defaults are: description = \"Managed by Terraform\" type = \"SecureString\" overwrite = true list(object({ name = string value = string description = string type = string overwrite = bool })) [] no alb_access_logs_s3_bucket_force_destroy A boolean that indicates all objects should be deleted from the ALB access logs S3 bucket so that the bucket can be destroyed without error bool false no alb_access_logs_s3_bucket_force_destroy_enabled When true , permits force_destroy to be set to true . This is an extra safety precaution to reduce the chance that Terraform will destroy and recreate your S3 bucket, causing COMPLETE LOSS OF ALL DATA even if it was stored in Glacier. WARNING: Upgrading this module from a version prior to 0.27.0 to this version will cause Terraform to delete your existing S3 bucket CAUSING COMPLETE DATA LOSS unless you follow the upgrade instructions on the Wiki here . See additional instructions for upgrading from v0.27.0 to v0.28.0 here . bool false no alb_certificate_arn ALB Certificate ARN. If var.create_acm_certificate is true , this will be ignored. string null no alb_idle_timeout The time that the connection is allowed to be idle. number 300 no alb_internal Determines if this load balancer is internally or externally facing. bool false no alb_ssl_policy Load Balancer SSL policy. string \"ELBSecurityPolicy-FS-1-2-Res-2020-10\" no alb_subnet_ids Subnet Ids assigned to the LB list(string) n/a yes cluster_name_override Name to assign the cluster. If null, the default will be namespace-environment-cluster string null no create_acm_certificate Create an ACM Certificate to use with the ALB bool true no environment ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT' string n/a yes execution_policy_attachment_arns The ARNs of the policies you want to apply list(string) [ \"arn:aws:iam::aws:policy/AmazonSSMReadOnlyAccess\", \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\" ] no health_check_route_53_private_zone Used with name field to get a private Hosted Zone bool false no health_check_route_53_records List of Route 53 records for the health check service. list(string) n/a yes health_check_subnet_ids Subnet IDs for the health check tasks to run in. If not defined, this will use var.alb_subnet_ids . list(string) [] no log_group_retention_days Specifies the number of days you want to retain log events in the specified log group. Possible values are: 1, 3, 5, 7, 14, 30, 60, 90, 120, 150, 180, 365, 400, 545, 731, 1096, 1827, 2192, 2557, 2922, 3288, 3653, and 0. If you select 0, the events in the log group are always retained and never expire number 30 no log_group_skip_destroy Set to true if you do not wish the log group (and any logs it may contain) to be deleted at destroy time, and instead just remove the log group from the Terraform state. bool false no namespace Namespace your resource belongs to. Usually an abbreviation of your organization name, e.g. 'example' or 'arc', to help ensure generated IDs are globally unique\" string n/a yes route_53_zone Route 53 domain to generate an ACM request for and to create A records against, i.e. sfrefarch.com. A wildcard subject alternative name is generated with the certificate. string n/a yes service_discovery_private_dns_namespace The name of the namespace list(string) [ \"default.example.local\" ] no tags Tags to assign the resources. map(string) {} no vpc_id Id of the VPC where the resources will live string n/a yes Outputs \u00b6 Name Description alb_arn ARN to the ALB alb_certificate_arn ACM Certificate ARN alb_dns_name External DNS name to the ALB cluster_arn ECS Cluster ARN cluster_id ECS Cluster ID cluster_name ECS Cluster name health_check_fqdn Health check FQDN record created in Route 53. SSM Parameters \u00b6 There are some commonly referenced outputs generated by this module. These outputs are also published to SSM for ease of access for downstream resources. The default SSM Parameter format used by this module is the following: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 [ ## alb { name = \"/${var.namespace}/${var.environment}/alb/${module.alb.alb_name}/endpoint\" value = module.alb.alb_dns_name description = \"ALB DNS Endpoint\" type = \"String\" }, { name = \"/${var.namespace}/${var.environment}/alb/${module.alb.alb_name}/arn\" value = module.alb.alb_arn description = \"ALB ARN\" type = \"String\" }, ## ecs { name = \"/${var.namespace}/${var.environment}/ecs/${module.ecs.cluster_name}/id\" value = module.ecs.cluster_id description = \"ECS Cluster ID\" type = \"String\" }, { name = \"/${var.namespace}/${var.environment}/ecs/${module.ecs.cluster_name}/arn\" value = module.ecs.cluster_arn description = \"ECS Cluster ARN\" type = \"String\" } ] You can append to this array by adding values to var.additional_ssm_params . Versioning \u00b6 This project uses a .version file at the root of the repo which the pipeline reads from and does a git tag. When you intend to commit to main , you will need to increment this version. Once the project is merged, the pipeline will kick off and tag the latest git commit. Development \u00b6 Prerequisites \u00b6 terraform terraform-docs pre-commit golang golint Configurations \u00b6 Configure pre-commit hooks 1 pre-commit install Tests \u00b6 Tests are available in test directory Configure the dependencies 1 2 3 cd test/ go mod init github.com/sourcefuse/terraform-aws-refarch-ecs go get github.com/gruntwork-io/terratest/modules/terraform Now execute the test 1 go test -timeout 30m Authors \u00b6 This project is authored by: - SourceFuse","title":"terraform-aws-refarch-ecs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#terraform-aws-ref-arch-ecs","text":"","title":"terraform-aws-ref-arch-ecs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#overview","text":"Terraform Module for AWS ECS by the SourceFuse ARC team. The module assumes that upstream dependencies, namely networking dependencies, are created upstream and the values are passed into this module via mechanisms such as Terraform data source queries. The module provisions ECS Cluster - we are focusing on the Fargate launch type, so we do not provision any underlying EC2 instances for the ECS launch type. Application Load Balancer Health Check Service - vanilla Nginx service that is used as the default route for the load balancer. The purpose of the health check service is to ensure that the core infrastructure, networking, security groups, etc. are configured correctly. Task execution IAM role - used by downstream services for task execution. Tags/SSM params - the module tags resources and outputs SSM params that can be used in data source lookups downstream for ECS services to reference to deploy into the cluster. Our approach to ECS Fargate clusters is to provision a cluster and allow downstream services to attach to it via convention based data source queries.","title":"Overview"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#usage","text":"1 2 3 module \"ecs\" { source = \"git::https://github.com/sourcefuse/terraform-aws-refarch-ecs\" }","title":"Usage"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#requirements","text":"Name Version terraform ~> 1.3 aws ~> 4.0","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#providers","text":"Name Version aws 4.57.1","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#modules","text":"Name Source Version acm git:: https://github.com/cloudposse/terraform-aws-acm-request-certificate 0.17.0 alb ./modules/alb n/a alb_sg git:: https://github.com/cloudposse/terraform-aws-security-group 2.0.0 ecs git:: https://github.com/terraform-aws-modules/terraform-aws-ecs v4.1.2 health_check ./modules/health-check n/a","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#resources","text":"Name Type aws_cloudwatch_log_group.this resource aws_iam_policy.secrets_manager_read_policy resource aws_iam_policy_attachment.execution resource aws_iam_policy_attachment.secrets_manager_read resource aws_iam_role.execution resource aws_lb_listener.http resource aws_lb_listener.https resource aws_service_discovery_private_dns_namespace.this resource aws_ssm_parameter.this resource aws_iam_policy_document.assume data source","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#inputs","text":"Name Description Type Default Required access_logs_enabled A boolean flag to enable/disable access_logs bool true no acm_domain_name Domain name the ACM Certificate belongs to string n/a yes acm_process_domain_validation_options Flag to enable/disable processing of the record to add to the DNS zone to complete certificate validation bool true no acm_process_domain_validation_record_ttl The TTL of the record to add to the DNS zone to complete certificate validation string \"300\" no acm_subject_alternative_names Subject alternative names for the ACM Certificate list(string) [] no additional_ssm_params Additional SSM Parameters you would like to add for your ECS configuration. The optional value defaults are: description = \"Managed by Terraform\" type = \"SecureString\" overwrite = true list(object({ name = string value = string description = string type = string overwrite = bool })) [] no alb_access_logs_s3_bucket_force_destroy A boolean that indicates all objects should be deleted from the ALB access logs S3 bucket so that the bucket can be destroyed without error bool false no alb_access_logs_s3_bucket_force_destroy_enabled When true , permits force_destroy to be set to true . This is an extra safety precaution to reduce the chance that Terraform will destroy and recreate your S3 bucket, causing COMPLETE LOSS OF ALL DATA even if it was stored in Glacier. WARNING: Upgrading this module from a version prior to 0.27.0 to this version will cause Terraform to delete your existing S3 bucket CAUSING COMPLETE DATA LOSS unless you follow the upgrade instructions on the Wiki here . See additional instructions for upgrading from v0.27.0 to v0.28.0 here . bool false no alb_certificate_arn ALB Certificate ARN. If var.create_acm_certificate is true , this will be ignored. string null no alb_idle_timeout The time that the connection is allowed to be idle. number 300 no alb_internal Determines if this load balancer is internally or externally facing. bool false no alb_ssl_policy Load Balancer SSL policy. string \"ELBSecurityPolicy-FS-1-2-Res-2020-10\" no alb_subnet_ids Subnet Ids assigned to the LB list(string) n/a yes cluster_name_override Name to assign the cluster. If null, the default will be namespace-environment-cluster string null no create_acm_certificate Create an ACM Certificate to use with the ALB bool true no environment ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT' string n/a yes execution_policy_attachment_arns The ARNs of the policies you want to apply list(string) [ \"arn:aws:iam::aws:policy/AmazonSSMReadOnlyAccess\", \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\" ] no health_check_route_53_private_zone Used with name field to get a private Hosted Zone bool false no health_check_route_53_records List of Route 53 records for the health check service. list(string) n/a yes health_check_subnet_ids Subnet IDs for the health check tasks to run in. If not defined, this will use var.alb_subnet_ids . list(string) [] no log_group_retention_days Specifies the number of days you want to retain log events in the specified log group. Possible values are: 1, 3, 5, 7, 14, 30, 60, 90, 120, 150, 180, 365, 400, 545, 731, 1096, 1827, 2192, 2557, 2922, 3288, 3653, and 0. If you select 0, the events in the log group are always retained and never expire number 30 no log_group_skip_destroy Set to true if you do not wish the log group (and any logs it may contain) to be deleted at destroy time, and instead just remove the log group from the Terraform state. bool false no namespace Namespace your resource belongs to. Usually an abbreviation of your organization name, e.g. 'example' or 'arc', to help ensure generated IDs are globally unique\" string n/a yes route_53_zone Route 53 domain to generate an ACM request for and to create A records against, i.e. sfrefarch.com. A wildcard subject alternative name is generated with the certificate. string n/a yes service_discovery_private_dns_namespace The name of the namespace list(string) [ \"default.example.local\" ] no tags Tags to assign the resources. map(string) {} no vpc_id Id of the VPC where the resources will live string n/a yes","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#outputs","text":"Name Description alb_arn ARN to the ALB alb_certificate_arn ACM Certificate ARN alb_dns_name External DNS name to the ALB cluster_arn ECS Cluster ARN cluster_id ECS Cluster ID cluster_name ECS Cluster name health_check_fqdn Health check FQDN record created in Route 53.","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#ssm-parameters","text":"There are some commonly referenced outputs generated by this module. These outputs are also published to SSM for ease of access for downstream resources. The default SSM Parameter format used by this module is the following: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 [ ## alb { name = \"/${var.namespace}/${var.environment}/alb/${module.alb.alb_name}/endpoint\" value = module.alb.alb_dns_name description = \"ALB DNS Endpoint\" type = \"String\" }, { name = \"/${var.namespace}/${var.environment}/alb/${module.alb.alb_name}/arn\" value = module.alb.alb_arn description = \"ALB ARN\" type = \"String\" }, ## ecs { name = \"/${var.namespace}/${var.environment}/ecs/${module.ecs.cluster_name}/id\" value = module.ecs.cluster_id description = \"ECS Cluster ID\" type = \"String\" }, { name = \"/${var.namespace}/${var.environment}/ecs/${module.ecs.cluster_name}/arn\" value = module.ecs.cluster_arn description = \"ECS Cluster ARN\" type = \"String\" } ] You can append to this array by adding values to var.additional_ssm_params .","title":"SSM Parameters"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#versioning","text":"This project uses a .version file at the root of the repo which the pipeline reads from and does a git tag. When you intend to commit to main , you will need to increment this version. Once the project is merged, the pipeline will kick off and tag the latest git commit.","title":"Versioning"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#development","text":"","title":"Development"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#prerequisites","text":"terraform terraform-docs pre-commit golang golint","title":"Prerequisites"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#configurations","text":"Configure pre-commit hooks 1 pre-commit install","title":"Configurations"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#tests","text":"Tests are available in test directory Configure the dependencies 1 2 3 cd test/ go mod init github.com/sourcefuse/terraform-aws-refarch-ecs go get github.com/gruntwork-io/terratest/modules/terraform Now execute the test 1 go test -timeout 30m","title":"Tests"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-ecs/#authors","text":"This project is authored by: - SourceFuse","title":"Authors"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/","text":"Terraform AWS: Reference Architecture - Tags \u00b6 This module is responsible for managing the tags we use at SourceFuse when creating resources in AWS. Requirements \u00b6 Name Version terraform >= 1.0, < 2.0 Providers \u00b6 No providers. Modules \u00b6 No modules. Resources \u00b6 No resources. Inputs \u00b6 Name Description Type Default Required environment The environment the resource will be created in. string n/a yes extra_tags Additional tags to add to your resources. map(string) {} no project The name of the project being worked on. string n/a yes Outputs \u00b6 Name Description extra_tags n/a tags n/a Requirements \u00b6 No requirements. Providers \u00b6 No providers. Modules \u00b6 No modules. Resources \u00b6 No resources. Inputs \u00b6 Name Description Type Default Required environment The environment the resource will be created in. any n/a yes extra_tags Additional tags to add to your resources. map(string) {} no project The name of the project being worked on. any n/a yes Outputs \u00b6 Name Description extra_tags n/a tags n/a","title":"terraform-aws-refarch-tags"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#terraform-aws-reference-architecture-tags","text":"This module is responsible for managing the tags we use at SourceFuse when creating resources in AWS.","title":"Terraform AWS: Reference Architecture - Tags"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#requirements","text":"Name Version terraform >= 1.0, < 2.0","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#providers","text":"No providers.","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#modules","text":"No modules.","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#resources","text":"No resources.","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#inputs","text":"Name Description Type Default Required environment The environment the resource will be created in. string n/a yes extra_tags Additional tags to add to your resources. map(string) {} no project The name of the project being worked on. string n/a yes","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#outputs","text":"Name Description extra_tags n/a tags n/a","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#requirements_1","text":"No requirements.","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#providers_1","text":"No providers.","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#modules_1","text":"No modules.","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#resources_1","text":"No resources.","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#inputs_1","text":"Name Description Type Default Required environment The environment the resource will be created in. any n/a yes extra_tags Additional tags to add to your resources. map(string) {} no project The name of the project being worked on. any n/a yes","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-aws-refarch-tags/#outputs_1","text":"Name Description extra_tags n/a tags n/a","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-k8s-app/","text":"terraform-k8s-app \u00b6 Overview \u00b6 Terraform module for deploying an application to a Kubernetes cluster. Usage \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 module \"terraform-k8s-app\" { source = \"git::https://github.com/sourcefuse/terraform-k8s-app.git\" for_each = local.k8s_apps app_label = each.value.app_label container_image = each.value.container_image container_name = each.value.container_name container_port = each.value.container_port deployment_name = each.value.deployment_name namespace_name = each.value.namespace_name port = each.value.port port_name = each.value.port_name protocol = each.value.protocol service_name = each.value.service_name target_port = each.value.target_port replica_count = each.value.replica_count ## pvc persistent_volume_claim_enable = try ( each.value.persistent_volume_claim_enable , false ) persistent_volume_claim_name = try ( each.value.persistent_volume_claim_name , null ) persistent_volume_claim_labels = try ( each.value.persistent_volume_claim_labels , {}) persistent_volume_claim_namespace = try ( each.value.persistent_volume_claim_namespace , null ) persistent_volume_claim_resource_request = try ( each.value.persistent_volume_claim_resource_request , {}) environment_variables = each.value.environment_variables } locals { redis_host = \"redis.${kubernetes_namespace.sourceloop_sandbox.metadata[0].name}.svc.cluster.local\" k8s_apps = { redis_application = { app_label = \"redis\" container_image = var.redis_image container_name = \"redis\" container_port = 6379 deployment_name = \"redis\" namespace_name = kubernetes_namespace.sourceloop_sandbox.metadata[0].name port = 6379 port_name = \"6379\" protocol = \"TCP\" service_name = \"redis\" target_port = 6379 replica_count = 1 environment_variables = [] } } } Requirements \u00b6 No requirements. Providers \u00b6 Name Version kubernetes 2.6.1 time 0.7.2 Modules \u00b6 No modules. Resources \u00b6 Name Type kubernetes_config_map.default resource kubernetes_deployment.default resource kubernetes_persistent_volume.default resource kubernetes_persistent_volume_claim.default resource kubernetes_secret.default resource kubernetes_service.default resource time_sleep.create_config resource Inputs \u00b6 Name Description Type Default Required app_label Value for the app label used for label matching string n/a yes config_map_binary_data Map of binary data for the config map. map(any) {} no config_map_data Map of data for the config map. map(any) {} no config_map_enabled Enable the Kubernetes config map. bool false no config_map_name Name to give the config map. any null no container_image Docker image for the k8s deployment string n/a yes container_name Name of container for the k8s deployment string n/a yes container_port Container port for the k8s deployment number n/a yes container_resources_enabled Enable container resource limits / requests. bool false no container_resources_limits Describes the maximum amount of compute resources allowed. For more info see http://kubernetes.io/docs/user-guide/compute-resources object({ cpu = string memory = string }) { \"cpu\": \"0.5\", \"memory\": \"512Mi\" } no container_resources_requests Describes the minimum amount of compute resources required. object({ cpu = string memory = string }) { \"cpu\": \"250m\", \"memory\": \"50Mi\" } no csi_secret_volumes List of maps of CSI volumes. These are used to dynamically generate the volume specs. list(object({ volume_name = string, mount_path = string, read_only = bool, driver = string, volume_attributes = object({ secretProviderClass = string }) })) [] no deployment_name Name of the k8s deployment string n/a yes enable_kubernetes_service Enable the kubernetes service. bool true no env_secret_refs List of secretKeyRefs to add to ENV variables. list(object({ env_var_name = string, secret_key_ref_name = string, secret_key_ref_key = string })) [] no environment_variables List of maps for environment variables list(object({ name = string, value = string })) [] no namespace_name Name of the k8s namespace string n/a yes persistent_volume_access_modes Contains all ways the volume can be mounted. Valid values are ReadWriteOnce, ReadOnlyMany, ReadWriteMany. list(string) [ \"ReadWriteMany\" ] no persistent_volume_annotations An unstructured key value map stored with the persistent volume that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_access_modes A set of the desired access modes the volume should have. list(string) [ \"ReadWriteMany\" ] no persistent_volume_claim_annotations An unstructured key value map stored with the persistent volume claim that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_enable Enable a persistent volume claim. bool false no persistent_volume_claim_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume claim. May match selectors of replication controllers and services. map(any) {} no persistent_volume_claim_name Name of the persistent volume claim, must be unique. Cannot be updated. any null no persistent_volume_claim_namespace Namespace defines the space within which name of the persistent volume claim must be unique. any null no persistent_volume_claim_resource_limits Map describing the maximum amount of compute resources allowed. map(string) {} no persistent_volume_claim_resource_request Map describing the minimum amount of compute resources required. map(string) { \"storage\": \"5Gi\" } no persistent_volume_claim_storage_class_name Name of the storage class requested by the claim. any null no persistent_volume_claim_storage_size Map describing the minimum amount of compute resources required. any null no persistent_volume_claim_volume_name The binding reference to the PersistentVolume backing this claim. any null no persistent_volume_enable Enable a persistent volume. bool false no persistent_volume_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume. May match selectors of replication controllers and services. map(any) {} no persistent_volume_mount_path Path to mount the persistent volume for secrets string \"/mnt/secrets-store\" no persistent_volume_name Name of the persistent volume, must be unique. Cannot be updated. any null no persistent_volume_reclaim_policy What happens to a persistent volume when released from its claim. Valid options are Retain (default), Delete and Recycle. Recycling must be supported by the volume plugin underlying this persistent volume. string \"Delete\" no persistent_volume_secret_provider_class Name of the secret provider class for CSI driver volume mounts for secret string null no persistent_volume_secrets_driver Driver for persistent volume. Defaults to CSI driver setting string \"secrets-store.csi.k8s.io\" no persistent_volume_storage_path Path of the directory on the host. any null no persistent_volume_storage_size Persistent volume size. string \"1Gi\" no port k8s service port number n/a yes port_name Name of the service port string n/a yes protocol k8s service protocol string n/a yes replica_count k8s Deployment replica count number n/a yes secret_annotations An unstructured key value map stored with the secret that may be used to store arbitrary metadata. any null no secret_data A map of the secret data. map(any) {} no secret_enable Enable Kubernetes secrets resource. bool false no secret_labels Map of string keys and values that can be used to organize and categorize (scope and select) the secret. map(any) {} no secret_name Name of the secret, must be unique. Cannot be updated. any null no secret_namespace Namespace defines the space within which name of the secret must be unique. any null no secret_type The secret type. Defaults to Opaque. See https://kubernetes.io/docs/concepts/configuration/secret/#secret-types for the different types. string \"Opaque\" no service_account_name Name of the service account to be used for this deployment. any null no service_name Name of the k8s service string n/a yes target_port k8s service target port number n/a yes Outputs \u00b6 Name Description host n/a service_name n/a service_port n/a Development \u00b6 Prerequisites \u00b6 Docker (Optional) golang golint pre-commit terraform terraform-docs Configurations \u00b6 Tests \u00b6 Tests are available in test directory located in the root of this project. Adding a new test \u00b6 When something new has been added to the terraform example configuration, it needs to be updated to include testing. This can be achieved by adding the test to test/example_test.go . For more information on Terratest, please see their Getting Started docs. For more information on k8s testing, see the k8s docs . Running with Docker \u00b6 The following instructions will be done from the root of the project. Build the image locally: 1 docker build -t terraform-k8s-app-test -f Dockerfile-test . Start the container: 1 docker run -it -v $HOME /.kube/config:/home/tester/.kube/config:ro --net = host terraform-k8s-app-test Running on the local system \u00b6 TL;DR: From the test directory, run go-test.sh to get all requirements and run a test. Configure golang deps for tests 1 2 3 4 5 go get github.com/gruntwork-io/terratest/modules/terraform go get github.com/gruntwork-io/terratest/modules/k8s go get github.com/stretchr/testify/assert go get testing go get fmt -OR- 1 ./go-get.sh From the test directory, run the below command: 1 go test -OR- 1 ./go-test.sh Authors \u00b6 This project is authored by: * SourceFuse Requirements \u00b6 No requirements. Providers \u00b6 Name Version kubernetes 2.6.1 time 0.7.2 Modules \u00b6 No modules. Resources \u00b6 Name Type kubernetes_config_map.default resource kubernetes_deployment.default resource kubernetes_persistent_volume.default resource kubernetes_persistent_volume_claim.default resource kubernetes_secret.default resource kubernetes_service.default resource time_sleep.create_config resource Inputs \u00b6 Name Description Type Default Required app_label Value for the app label used for label matching string n/a yes config_map_binary_data Map of binary data for the config map. map(any) {} no config_map_data Map of data for the config map. map(any) {} no config_map_enabled Enable the Kubernetes config map. bool false no config_map_name Name to give the config map. any null no container_image Docker image for the k8s deployment string n/a yes container_name Name of container for the k8s deployment string n/a yes container_port Container port for the k8s deployment number n/a yes container_resources_enabled Enable container resource limits / requests. bool false no container_resources_limits Describes the maximum amount of compute resources allowed. For more info see http://kubernetes.io/docs/user-guide/compute-resources object({ cpu = string memory = string }) { \"cpu\": \"0.5\", \"memory\": \"512Mi\" } no container_resources_requests Describes the minimum amount of compute resources required. object({ cpu = string memory = string }) { \"cpu\": \"250m\", \"memory\": \"50Mi\" } no csi_secret_volumes List of maps of CSI volumes. These are used to dynamically generate the volume specs. list(object({ volume_name = string, mount_path = string, read_only = bool, driver = string, volume_attributes = object({ secretProviderClass = string }) })) [] no deployment_name Name of the k8s deployment string n/a yes enable_kubernetes_service Enable the kubernetes service. bool true no env_secret_refs List of secretKeyRefs to add to ENV variables. list(object({ env_var_name = string, secret_key_ref_name = string, secret_key_ref_key = string })) [] no environment_variables List of maps for environment variables list(object({ name = string, value = string })) [] no namespace_name Name of the k8s namespace string n/a yes persistent_volume_access_modes Contains all ways the volume can be mounted. Valid values are ReadWriteOnce, ReadOnlyMany, ReadWriteMany. list(string) [ \"ReadWriteMany\" ] no persistent_volume_annotations An unstructured key value map stored with the persistent volume that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_access_modes A set of the desired access modes the volume should have. list(string) [ \"ReadWriteMany\" ] no persistent_volume_claim_annotations An unstructured key value map stored with the persistent volume claim that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_enable Enable a persistent volume claim. bool false no persistent_volume_claim_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume claim. May match selectors of replication controllers and services. map(any) {} no persistent_volume_claim_name Name of the persistent volume claim, must be unique. Cannot be updated. any null no persistent_volume_claim_namespace Namespace defines the space within which name of the persistent volume claim must be unique. any null no persistent_volume_claim_resource_limits Map describing the maximum amount of compute resources allowed. map(string) {} no persistent_volume_claim_resource_request Map describing the minimum amount of compute resources required. map(string) { \"storage\": \"5Gi\" } no persistent_volume_claim_storage_class_name Name of the storage class requested by the claim. any null no persistent_volume_claim_storage_size Map describing the minimum amount of compute resources required. any null no persistent_volume_claim_volume_name The binding reference to the PersistentVolume backing this claim. any null no persistent_volume_enable Enable a persistent volume. bool false no persistent_volume_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume. May match selectors of replication controllers and services. map(any) {} no persistent_volume_mount_path Path to mount the persistent volume for secrets string \"/mnt/secrets-store\" no persistent_volume_name Name of the persistent volume, must be unique. Cannot be updated. any null no persistent_volume_reclaim_policy What happens to a persistent volume when released from its claim. Valid options are Retain (default), Delete and Recycle. Recycling must be supported by the volume plugin underlying this persistent volume. string \"Delete\" no persistent_volume_secret_provider_class Name of the secret provider class for CSI driver volume mounts for secret string null no persistent_volume_secrets_driver Driver for persistent volume. Defaults to CSI driver setting string \"secrets-store.csi.k8s.io\" no persistent_volume_storage_path Path of the directory on the host. any null no persistent_volume_storage_size Persistent volume size. string \"1Gi\" no port k8s service port number n/a yes port_name Name of the service port string n/a yes protocol k8s service protocol string n/a yes replica_count k8s Deployment replica count number n/a yes secret_annotations An unstructured key value map stored with the secret that may be used to store arbitrary metadata. any null no secret_data A map of the secret data. map(any) {} no secret_enable Enable Kubernetes secrets resource. bool false no secret_labels Map of string keys and values that can be used to organize and categorize (scope and select) the secret. map(any) {} no secret_name Name of the secret, must be unique. Cannot be updated. any null no secret_namespace Namespace defines the space within which name of the secret must be unique. any null no secret_type The secret type. Defaults to Opaque. See https://kubernetes.io/docs/concepts/configuration/secret/#secret-types for the different types. string \"Opaque\" no service_account_name Name of the service account to be used for this deployment. any null no service_name Name of the k8s service string n/a yes target_port k8s service target port number n/a yes Outputs \u00b6 Name Description host n/a service_name n/a service_port n/a","title":"terraform-k8s-app"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#terraform-k8s-app","text":"","title":"terraform-k8s-app"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#overview","text":"Terraform module for deploying an application to a Kubernetes cluster.","title":"Overview"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#usage","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 module \"terraform-k8s-app\" { source = \"git::https://github.com/sourcefuse/terraform-k8s-app.git\" for_each = local.k8s_apps app_label = each.value.app_label container_image = each.value.container_image container_name = each.value.container_name container_port = each.value.container_port deployment_name = each.value.deployment_name namespace_name = each.value.namespace_name port = each.value.port port_name = each.value.port_name protocol = each.value.protocol service_name = each.value.service_name target_port = each.value.target_port replica_count = each.value.replica_count ## pvc persistent_volume_claim_enable = try ( each.value.persistent_volume_claim_enable , false ) persistent_volume_claim_name = try ( each.value.persistent_volume_claim_name , null ) persistent_volume_claim_labels = try ( each.value.persistent_volume_claim_labels , {}) persistent_volume_claim_namespace = try ( each.value.persistent_volume_claim_namespace , null ) persistent_volume_claim_resource_request = try ( each.value.persistent_volume_claim_resource_request , {}) environment_variables = each.value.environment_variables } locals { redis_host = \"redis.${kubernetes_namespace.sourceloop_sandbox.metadata[0].name}.svc.cluster.local\" k8s_apps = { redis_application = { app_label = \"redis\" container_image = var.redis_image container_name = \"redis\" container_port = 6379 deployment_name = \"redis\" namespace_name = kubernetes_namespace.sourceloop_sandbox.metadata[0].name port = 6379 port_name = \"6379\" protocol = \"TCP\" service_name = \"redis\" target_port = 6379 replica_count = 1 environment_variables = [] } } }","title":"Usage"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#requirements","text":"No requirements.","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#providers","text":"Name Version kubernetes 2.6.1 time 0.7.2","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#modules","text":"No modules.","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#resources","text":"Name Type kubernetes_config_map.default resource kubernetes_deployment.default resource kubernetes_persistent_volume.default resource kubernetes_persistent_volume_claim.default resource kubernetes_secret.default resource kubernetes_service.default resource time_sleep.create_config resource","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#inputs","text":"Name Description Type Default Required app_label Value for the app label used for label matching string n/a yes config_map_binary_data Map of binary data for the config map. map(any) {} no config_map_data Map of data for the config map. map(any) {} no config_map_enabled Enable the Kubernetes config map. bool false no config_map_name Name to give the config map. any null no container_image Docker image for the k8s deployment string n/a yes container_name Name of container for the k8s deployment string n/a yes container_port Container port for the k8s deployment number n/a yes container_resources_enabled Enable container resource limits / requests. bool false no container_resources_limits Describes the maximum amount of compute resources allowed. For more info see http://kubernetes.io/docs/user-guide/compute-resources object({ cpu = string memory = string }) { \"cpu\": \"0.5\", \"memory\": \"512Mi\" } no container_resources_requests Describes the minimum amount of compute resources required. object({ cpu = string memory = string }) { \"cpu\": \"250m\", \"memory\": \"50Mi\" } no csi_secret_volumes List of maps of CSI volumes. These are used to dynamically generate the volume specs. list(object({ volume_name = string, mount_path = string, read_only = bool, driver = string, volume_attributes = object({ secretProviderClass = string }) })) [] no deployment_name Name of the k8s deployment string n/a yes enable_kubernetes_service Enable the kubernetes service. bool true no env_secret_refs List of secretKeyRefs to add to ENV variables. list(object({ env_var_name = string, secret_key_ref_name = string, secret_key_ref_key = string })) [] no environment_variables List of maps for environment variables list(object({ name = string, value = string })) [] no namespace_name Name of the k8s namespace string n/a yes persistent_volume_access_modes Contains all ways the volume can be mounted. Valid values are ReadWriteOnce, ReadOnlyMany, ReadWriteMany. list(string) [ \"ReadWriteMany\" ] no persistent_volume_annotations An unstructured key value map stored with the persistent volume that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_access_modes A set of the desired access modes the volume should have. list(string) [ \"ReadWriteMany\" ] no persistent_volume_claim_annotations An unstructured key value map stored with the persistent volume claim that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_enable Enable a persistent volume claim. bool false no persistent_volume_claim_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume claim. May match selectors of replication controllers and services. map(any) {} no persistent_volume_claim_name Name of the persistent volume claim, must be unique. Cannot be updated. any null no persistent_volume_claim_namespace Namespace defines the space within which name of the persistent volume claim must be unique. any null no persistent_volume_claim_resource_limits Map describing the maximum amount of compute resources allowed. map(string) {} no persistent_volume_claim_resource_request Map describing the minimum amount of compute resources required. map(string) { \"storage\": \"5Gi\" } no persistent_volume_claim_storage_class_name Name of the storage class requested by the claim. any null no persistent_volume_claim_storage_size Map describing the minimum amount of compute resources required. any null no persistent_volume_claim_volume_name The binding reference to the PersistentVolume backing this claim. any null no persistent_volume_enable Enable a persistent volume. bool false no persistent_volume_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume. May match selectors of replication controllers and services. map(any) {} no persistent_volume_mount_path Path to mount the persistent volume for secrets string \"/mnt/secrets-store\" no persistent_volume_name Name of the persistent volume, must be unique. Cannot be updated. any null no persistent_volume_reclaim_policy What happens to a persistent volume when released from its claim. Valid options are Retain (default), Delete and Recycle. Recycling must be supported by the volume plugin underlying this persistent volume. string \"Delete\" no persistent_volume_secret_provider_class Name of the secret provider class for CSI driver volume mounts for secret string null no persistent_volume_secrets_driver Driver for persistent volume. Defaults to CSI driver setting string \"secrets-store.csi.k8s.io\" no persistent_volume_storage_path Path of the directory on the host. any null no persistent_volume_storage_size Persistent volume size. string \"1Gi\" no port k8s service port number n/a yes port_name Name of the service port string n/a yes protocol k8s service protocol string n/a yes replica_count k8s Deployment replica count number n/a yes secret_annotations An unstructured key value map stored with the secret that may be used to store arbitrary metadata. any null no secret_data A map of the secret data. map(any) {} no secret_enable Enable Kubernetes secrets resource. bool false no secret_labels Map of string keys and values that can be used to organize and categorize (scope and select) the secret. map(any) {} no secret_name Name of the secret, must be unique. Cannot be updated. any null no secret_namespace Namespace defines the space within which name of the secret must be unique. any null no secret_type The secret type. Defaults to Opaque. See https://kubernetes.io/docs/concepts/configuration/secret/#secret-types for the different types. string \"Opaque\" no service_account_name Name of the service account to be used for this deployment. any null no service_name Name of the k8s service string n/a yes target_port k8s service target port number n/a yes","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#outputs","text":"Name Description host n/a service_name n/a service_port n/a","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#development","text":"","title":"Development"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#prerequisites","text":"Docker (Optional) golang golint pre-commit terraform terraform-docs","title":"Prerequisites"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#configurations","text":"","title":"Configurations"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#tests","text":"Tests are available in test directory located in the root of this project.","title":"Tests"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#adding-a-new-test","text":"When something new has been added to the terraform example configuration, it needs to be updated to include testing. This can be achieved by adding the test to test/example_test.go . For more information on Terratest, please see their Getting Started docs. For more information on k8s testing, see the k8s docs .","title":"Adding a new test"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#running-with-docker","text":"The following instructions will be done from the root of the project. Build the image locally: 1 docker build -t terraform-k8s-app-test -f Dockerfile-test . Start the container: 1 docker run -it -v $HOME /.kube/config:/home/tester/.kube/config:ro --net = host terraform-k8s-app-test","title":"Running with Docker"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#running-on-the-local-system","text":"TL;DR: From the test directory, run go-test.sh to get all requirements and run a test. Configure golang deps for tests 1 2 3 4 5 go get github.com/gruntwork-io/terratest/modules/terraform go get github.com/gruntwork-io/terratest/modules/k8s go get github.com/stretchr/testify/assert go get testing go get fmt -OR- 1 ./go-get.sh From the test directory, run the below command: 1 go test -OR- 1 ./go-test.sh","title":"Running on the local system"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#authors","text":"This project is authored by: * SourceFuse","title":"Authors"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#requirements_1","text":"No requirements.","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#providers_1","text":"Name Version kubernetes 2.6.1 time 0.7.2","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#modules_1","text":"No modules.","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#resources_1","text":"Name Type kubernetes_config_map.default resource kubernetes_deployment.default resource kubernetes_persistent_volume.default resource kubernetes_persistent_volume_claim.default resource kubernetes_secret.default resource kubernetes_service.default resource time_sleep.create_config resource","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#inputs_1","text":"Name Description Type Default Required app_label Value for the app label used for label matching string n/a yes config_map_binary_data Map of binary data for the config map. map(any) {} no config_map_data Map of data for the config map. map(any) {} no config_map_enabled Enable the Kubernetes config map. bool false no config_map_name Name to give the config map. any null no container_image Docker image for the k8s deployment string n/a yes container_name Name of container for the k8s deployment string n/a yes container_port Container port for the k8s deployment number n/a yes container_resources_enabled Enable container resource limits / requests. bool false no container_resources_limits Describes the maximum amount of compute resources allowed. For more info see http://kubernetes.io/docs/user-guide/compute-resources object({ cpu = string memory = string }) { \"cpu\": \"0.5\", \"memory\": \"512Mi\" } no container_resources_requests Describes the minimum amount of compute resources required. object({ cpu = string memory = string }) { \"cpu\": \"250m\", \"memory\": \"50Mi\" } no csi_secret_volumes List of maps of CSI volumes. These are used to dynamically generate the volume specs. list(object({ volume_name = string, mount_path = string, read_only = bool, driver = string, volume_attributes = object({ secretProviderClass = string }) })) [] no deployment_name Name of the k8s deployment string n/a yes enable_kubernetes_service Enable the kubernetes service. bool true no env_secret_refs List of secretKeyRefs to add to ENV variables. list(object({ env_var_name = string, secret_key_ref_name = string, secret_key_ref_key = string })) [] no environment_variables List of maps for environment variables list(object({ name = string, value = string })) [] no namespace_name Name of the k8s namespace string n/a yes persistent_volume_access_modes Contains all ways the volume can be mounted. Valid values are ReadWriteOnce, ReadOnlyMany, ReadWriteMany. list(string) [ \"ReadWriteMany\" ] no persistent_volume_annotations An unstructured key value map stored with the persistent volume that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_access_modes A set of the desired access modes the volume should have. list(string) [ \"ReadWriteMany\" ] no persistent_volume_claim_annotations An unstructured key value map stored with the persistent volume claim that may be used to store arbitrary metadata. map(any) {} no persistent_volume_claim_enable Enable a persistent volume claim. bool false no persistent_volume_claim_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume claim. May match selectors of replication controllers and services. map(any) {} no persistent_volume_claim_name Name of the persistent volume claim, must be unique. Cannot be updated. any null no persistent_volume_claim_namespace Namespace defines the space within which name of the persistent volume claim must be unique. any null no persistent_volume_claim_resource_limits Map describing the maximum amount of compute resources allowed. map(string) {} no persistent_volume_claim_resource_request Map describing the minimum amount of compute resources required. map(string) { \"storage\": \"5Gi\" } no persistent_volume_claim_storage_class_name Name of the storage class requested by the claim. any null no persistent_volume_claim_storage_size Map describing the minimum amount of compute resources required. any null no persistent_volume_claim_volume_name The binding reference to the PersistentVolume backing this claim. any null no persistent_volume_enable Enable a persistent volume. bool false no persistent_volume_labels Map of string keys and values that can be used to organize and categorize (scope and select) the persistent volume. May match selectors of replication controllers and services. map(any) {} no persistent_volume_mount_path Path to mount the persistent volume for secrets string \"/mnt/secrets-store\" no persistent_volume_name Name of the persistent volume, must be unique. Cannot be updated. any null no persistent_volume_reclaim_policy What happens to a persistent volume when released from its claim. Valid options are Retain (default), Delete and Recycle. Recycling must be supported by the volume plugin underlying this persistent volume. string \"Delete\" no persistent_volume_secret_provider_class Name of the secret provider class for CSI driver volume mounts for secret string null no persistent_volume_secrets_driver Driver for persistent volume. Defaults to CSI driver setting string \"secrets-store.csi.k8s.io\" no persistent_volume_storage_path Path of the directory on the host. any null no persistent_volume_storage_size Persistent volume size. string \"1Gi\" no port k8s service port number n/a yes port_name Name of the service port string n/a yes protocol k8s service protocol string n/a yes replica_count k8s Deployment replica count number n/a yes secret_annotations An unstructured key value map stored with the secret that may be used to store arbitrary metadata. any null no secret_data A map of the secret data. map(any) {} no secret_enable Enable Kubernetes secrets resource. bool false no secret_labels Map of string keys and values that can be used to organize and categorize (scope and select) the secret. map(any) {} no secret_name Name of the secret, must be unique. Cannot be updated. any null no secret_namespace Namespace defines the space within which name of the secret must be unique. any null no secret_type The secret type. Defaults to Opaque. See https://kubernetes.io/docs/concepts/configuration/secret/#secret-types for the different types. string \"Opaque\" no service_account_name Name of the service account to be used for this deployment. any null no service_name Name of the k8s service string n/a yes target_port k8s service target port number n/a yes","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-k8s-app/#outputs_1","text":"Name Description host n/a service_name n/a service_port n/a","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/","text":"Terraform Module: Bootstrap \u00b6 This module creates and configures a S3 bucket backend and DynamoDB lock table for terraform state files. Getting Started \u00b6 1 2 3 4 5 6 module \"bootstrap\" { source = \"git::https://github.com/sourcefuse/terraform-module-aws-bootstrap\" bucket_name = \"thisisasamplebucket\" dynamodb_name = \"terraform-lock\" } Requirements \u00b6 Name Version aws ~> 3.0 Providers \u00b6 Name Version aws ~> 3.0 Modules \u00b6 No modules. Resources \u00b6 Name Type aws_dynamodb_table.terraform_state_lock resource aws_s3_bucket.private resource aws_s3_bucket_analytics_configuration.private_analytics_config resource aws_s3_bucket_inventory.inventory resource aws_s3_bucket_public_access_block.public_access_block resource aws_caller_identity.current data source aws_iam_policy_document.policy data source aws_partition.current data source Inputs \u00b6 Name Description Type Default Required abort_incomplete_multipart_upload_days Specifies the number of days after initiating a multipart upload when the multipart upload must be completed. number 14 no bucket_key_enabled Whether or not to use Amazon S3 Bucket Keys for SSE-KMS. bool false no bucket_name The name of the bucket. any n/a yes cors_rules List of maps containing rules for Cross-Origin Resource Sharing. list(any) [] no dynamodb_hash_key The attribute to use as the hash (partition) key. string \"LockID\" no dynamodb_name The name of the table, this needs to be unique within a region. any n/a yes enable_analytics Enables storage class analytics on the bucket. bool true no enable_bucket_force_destroy A boolean that indicates all objects (including any locked objects) should be deleted from the bucket so that the bucket can be destroyed without error. bool false no enable_bucket_inventory If set to true, Bucket Inventory will be enabled. bool false no enable_bucket_logging Enable bucket activity logging. bool false no enable_dynamodb_point_in_time_recovery Whether to enable point-in-time recovery - note that it can take up to 10 minutes to enable for new tables. bool false no enable_s3_public_access_block Bool for toggling whether the s3 public access block resource should be enabled. bool true no enable_versioning Enable versioning. Once you version-enable a bucket, it can never return to an unversioned state. bool true no expiration Specifies a period in the object's expire. list(any) [ { \"expired_object_delete_marker\": true } ] no inventory_bucket_format The format for the inventory file. Default is ORC. Options are ORC or CSV. string \"ORC\" no kms_master_key_id The AWS KMS master key ID used for the SSE-KMS encryption. string \"\" no logging_bucket_name The S3 bucket to send S3 access logs. string \"\" no logging_bucket_target_prefix To specify a key prefix for log objects. string \"\" no noncurrent_version_expiration Number of days until non-current version of object expires number 365 no noncurrent_version_transitions Non-current version transition blocks list(any) [ { \"days\": 30, \"storage_class\": \"STANDARD_IA\" } ] no schedule_frequency The S3 bucket inventory frequency. Defaults to Weekly. Options are 'Weekly' or 'Daily'. string \"Weekly\" no sse_algorithm The server-side encryption algorithm to use. Valid values are AES256 and aws:kms string \"AES256\" no tags A mapping of tags to assign to the bucket. map(string) { \"Module\": \"terraform-module-aws-bootstrap\", \"TerraformManaged\": \"true\" } no transitions Current version transition blocks list(any) [] no Outputs \u00b6 Name Description bucket_arn n/a bucket_id n/a bucket_name n/a dynamodb_arn n/a dynamodb_id n/a dynamodb_name n/a Bootstrapping \u00b6 Initial Setup \u00b6 On initial run, this project will create a local terraform state file. DO NOT delete this file. Once our backend and lock table are created, we will migrate the state to the new backend. Migrating local state to backend \u00b6 This can only be done once without affecting all workspaces. After the initial apply of terraform, you can uncomment this section and save the state to the backend. 1 2 3 4 5 6 7 8 9 10 11 terraform { required_version = \"~> 1.0.3\" backend \"s3\" { region = \"us-east-1\" key = \"terraform-bootstrap/terraform.tfstate\" bucket = \"terraformbucketexample\" dynamodb_table = \"terraform-lock\" encrypt = true } } Then run terraform init to initialize the new backend: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Initializing modules... Initializing the backend... Do you want to migrate all workspaces to \"aws\"? Both the existing \"local\" backend and the newly configured \"aws\" backend support workspaces. When migrating between backends, Terraform will copy all workspaces (with the same names). THIS WILL OVERWRITE any conflicting states in the destination. Terraform initialization doesn't currently migrate only select workspaces. If you want to migrate a select number of workspaces, you must manually pull and push those states. If you answer \"yes\", Terraform will migrate all states. If you answer \"no\", Terraform will abort. Our local state has now been migrated to the new backend. It is now safe to remove the local terraform.tfstate . Development \u00b6 Versioning \u00b6 Versioning is done manually at the moment and a tracking issue has been created to automate the git tag task. On commits to master , you are required to update the version.json at the root of this project to the next semantic version. Prerequisites \u00b6 terraform-docs pre-commit golang golint Configurations \u00b6 Configure pre-commit hooks 1 pre-commit install Configure golang deps for tests 1 2 go get github.com/gruntwork-io/terratest/modules/terraform go get github.com/stretchr/testify/assert Execute pre-commit 1 pre-commit run -a Authors \u00b6 This project is authored by below people james.crowley@sourcefuse.com travis.saucier@sourcefuse.com This project was generated by generator-tf-module","title":"terraform-module-aws-bootstrap"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#terraform-module-bootstrap","text":"This module creates and configures a S3 bucket backend and DynamoDB lock table for terraform state files.","title":"Terraform Module: Bootstrap"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#getting-started","text":"1 2 3 4 5 6 module \"bootstrap\" { source = \"git::https://github.com/sourcefuse/terraform-module-aws-bootstrap\" bucket_name = \"thisisasamplebucket\" dynamodb_name = \"terraform-lock\" }","title":"Getting Started"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#requirements","text":"Name Version aws ~> 3.0","title":"Requirements"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#providers","text":"Name Version aws ~> 3.0","title":"Providers"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#modules","text":"No modules.","title":"Modules"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#resources","text":"Name Type aws_dynamodb_table.terraform_state_lock resource aws_s3_bucket.private resource aws_s3_bucket_analytics_configuration.private_analytics_config resource aws_s3_bucket_inventory.inventory resource aws_s3_bucket_public_access_block.public_access_block resource aws_caller_identity.current data source aws_iam_policy_document.policy data source aws_partition.current data source","title":"Resources"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#inputs","text":"Name Description Type Default Required abort_incomplete_multipart_upload_days Specifies the number of days after initiating a multipart upload when the multipart upload must be completed. number 14 no bucket_key_enabled Whether or not to use Amazon S3 Bucket Keys for SSE-KMS. bool false no bucket_name The name of the bucket. any n/a yes cors_rules List of maps containing rules for Cross-Origin Resource Sharing. list(any) [] no dynamodb_hash_key The attribute to use as the hash (partition) key. string \"LockID\" no dynamodb_name The name of the table, this needs to be unique within a region. any n/a yes enable_analytics Enables storage class analytics on the bucket. bool true no enable_bucket_force_destroy A boolean that indicates all objects (including any locked objects) should be deleted from the bucket so that the bucket can be destroyed without error. bool false no enable_bucket_inventory If set to true, Bucket Inventory will be enabled. bool false no enable_bucket_logging Enable bucket activity logging. bool false no enable_dynamodb_point_in_time_recovery Whether to enable point-in-time recovery - note that it can take up to 10 minutes to enable for new tables. bool false no enable_s3_public_access_block Bool for toggling whether the s3 public access block resource should be enabled. bool true no enable_versioning Enable versioning. Once you version-enable a bucket, it can never return to an unversioned state. bool true no expiration Specifies a period in the object's expire. list(any) [ { \"expired_object_delete_marker\": true } ] no inventory_bucket_format The format for the inventory file. Default is ORC. Options are ORC or CSV. string \"ORC\" no kms_master_key_id The AWS KMS master key ID used for the SSE-KMS encryption. string \"\" no logging_bucket_name The S3 bucket to send S3 access logs. string \"\" no logging_bucket_target_prefix To specify a key prefix for log objects. string \"\" no noncurrent_version_expiration Number of days until non-current version of object expires number 365 no noncurrent_version_transitions Non-current version transition blocks list(any) [ { \"days\": 30, \"storage_class\": \"STANDARD_IA\" } ] no schedule_frequency The S3 bucket inventory frequency. Defaults to Weekly. Options are 'Weekly' or 'Daily'. string \"Weekly\" no sse_algorithm The server-side encryption algorithm to use. Valid values are AES256 and aws:kms string \"AES256\" no tags A mapping of tags to assign to the bucket. map(string) { \"Module\": \"terraform-module-aws-bootstrap\", \"TerraformManaged\": \"true\" } no transitions Current version transition blocks list(any) [] no","title":"Inputs"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#outputs","text":"Name Description bucket_arn n/a bucket_id n/a bucket_name n/a dynamodb_arn n/a dynamodb_id n/a dynamodb_name n/a","title":"Outputs"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#bootstrapping","text":"","title":"Bootstrapping"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#initial-setup","text":"On initial run, this project will create a local terraform state file. DO NOT delete this file. Once our backend and lock table are created, we will migrate the state to the new backend.","title":"Initial Setup"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#migrating-local-state-to-backend","text":"This can only be done once without affecting all workspaces. After the initial apply of terraform, you can uncomment this section and save the state to the backend. 1 2 3 4 5 6 7 8 9 10 11 terraform { required_version = \"~> 1.0.3\" backend \"s3\" { region = \"us-east-1\" key = \"terraform-bootstrap/terraform.tfstate\" bucket = \"terraformbucketexample\" dynamodb_table = \"terraform-lock\" encrypt = true } } Then run terraform init to initialize the new backend: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Initializing modules... Initializing the backend... Do you want to migrate all workspaces to \"aws\"? Both the existing \"local\" backend and the newly configured \"aws\" backend support workspaces. When migrating between backends, Terraform will copy all workspaces (with the same names). THIS WILL OVERWRITE any conflicting states in the destination. Terraform initialization doesn't currently migrate only select workspaces. If you want to migrate a select number of workspaces, you must manually pull and push those states. If you answer \"yes\", Terraform will migrate all states. If you answer \"no\", Terraform will abort. Our local state has now been migrated to the new backend. It is now safe to remove the local terraform.tfstate .","title":"Migrating local state to backend"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#development","text":"","title":"Development"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#versioning","text":"Versioning is done manually at the moment and a tracking issue has been created to automate the git tag task. On commits to master , you are required to update the version.json at the root of this project to the next semantic version.","title":"Versioning"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#prerequisites","text":"terraform-docs pre-commit golang golint","title":"Prerequisites"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#configurations","text":"Configure pre-commit hooks 1 pre-commit install Configure golang deps for tests 1 2 go get github.com/gruntwork-io/terratest/modules/terraform go get github.com/stretchr/testify/assert Execute pre-commit 1 pre-commit run -a","title":"Configurations"},{"location":"arc-iac-docs/modules/terraform-module-aws-bootstrap/#authors","text":"This project is authored by below people james.crowley@sourcefuse.com travis.saucier@sourcefuse.com This project was generated by generator-tf-module","title":"Authors"},{"location":"arc-iac-docs/reference_architectures/aws_account_baseline/","text":"AWS Account Baseline \u00b6 The AWS account baseline creates an AWS landing zone that provides Centralized identity and access management Standardized multi-account structure for the segregation of workload by environment designation Centralized audit logging and security controls A fully automated solution. The example above utilizes our integration with the Account Factory for Terraform . For less complex architectures, we typically deploy the AFT. For more complicated architectures or compliance heavy architectures, we typically deploy a customized version of the Landing Zone Accelerator .","title":"AWS Account Baseline"},{"location":"arc-iac-docs/reference_architectures/aws_account_baseline/#aws-account-baseline","text":"The AWS account baseline creates an AWS landing zone that provides Centralized identity and access management Standardized multi-account structure for the segregation of workload by environment designation Centralized audit logging and security controls A fully automated solution. The example above utilizes our integration with the Account Factory for Terraform . For less complex architectures, we typically deploy the AFT. For more complicated architectures or compliance heavy architectures, we typically deploy a customized version of the Landing Zone Accelerator .","title":"AWS Account Baseline"},{"location":"arc-iac-docs/reference_architectures/ecs_platform_baseline/","text":"ECS Platform Baseline \u00b6","title":"ECS Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/ecs_platform_baseline/#ecs-platform-baseline","text":"","title":"ECS Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/eks_platform_baseline/","text":"EKS Platform Baseline \u00b6","title":"EKS Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/eks_platform_baseline/#eks-platform-baseline","text":"","title":"EKS Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/lambda_platform_baseline/","text":"Lambda Platform Baseline \u00b6 Coming Soon!","title":"Lambda Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/lambda_platform_baseline/#lambda-platform-baseline","text":"Coming Soon!","title":"Lambda Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/network_baseline/","text":"Network Baseline \u00b6","title":"Network Baseline"},{"location":"arc-iac-docs/reference_architectures/network_baseline/#network-baseline","text":"","title":"Network Baseline"},{"location":"arc-iac-docs/reference_architectures/windows_basic_platform_baseline/","text":"Windows Basic Platform Baseline \u00b6","title":"Windows Basic Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/windows_basic_platform_baseline/#windows-basic-platform-baseline","text":"","title":"Windows Basic Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/windows_enterprise_platform_baseline/","text":"Windows Enterprise Platform Baseline \u00b6","title":"Windows Enterprise Platform Baseline"},{"location":"arc-iac-docs/reference_architectures/windows_enterprise_platform_baseline/#windows-enterprise-platform-baseline","text":"","title":"Windows Enterprise Platform Baseline"},{"location":"arc-ui-docs/","text":"ARC UI \u00b6 Coming soon!","title":"Introduction"},{"location":"arc-ui-docs/#arc-ui","text":"Coming soon!","title":"ARC UI"}]}